/* --- å…¨å±€ä¸ä¸»é¢˜æ ·å¼ --- */
:root {
    --bg-color: #fce4ec;
    --primary-color: #ff80ab;
    --secondary-color: #f48fb1;
    --accent-color: #90caf9;
    --text-color: #444;
    --white-color: #fff;
    --border-radius: 18px;
    --phone-corner-radius: 0px;
    --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --top-pinned-bg: #fff0f5;
    --online-status-color: #4CAF50;
}

*,
*::before,
*::after {
    box-sizing: border-box;
}

body {
    font-family: var(--font-family);
    margin: 0;
    padding: 0;
    background: linear-gradient(135deg, #fce4ec, #f8bbd0);
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.phone-screen {
    width: 100%;
    max-width: 420px;
    height: 100vh;
    max-height: 850px;
    background-color: var(--white-color);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    border-radius: var(--phone-corner-radius);
    overflow: hidden;
    position: relative;
    display: flex;
    flex-direction: column;
}

.screen {
    display: none;
    flex-direction: column;
    width: 100%;
    height: 100%;
    animation: fadeIn 0.5s ease;
}

.screen.active {
    display: flex;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

.app-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #eee;
    flex-shrink: 0;
    position: relative;
    z-index: 10;
}

.app-header .back-btn,
.app-header .action-btn {
    background: none;
    border: none;
    font-size: 24px;
    font-weight: bold;
    color: var(--primary-color);
    cursor: pointer;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

#cancel-multi-select-btn {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--white-color) !important;
    background-color: var(--primary-color) !important;
    border-radius: 10px !important;
    padding: 5px 10px !important;
    width: auto !important;
    height: auto !important;
}

.app-header .action-btn-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

.app-header .action-btn-group .action-btn {
    font-size: 16px;
    font-weight: 600;
    width: auto;
    padding: 6px 12px;
    border-radius: 10px;
}

.app-header .action-btn-group #create-group-btn {
    background-color: var(--primary-color);
    color: var(--white-color);
}

.app-header .action-btn-group #add-chat-btn {
    font-size: 28px;
    padding: 0;
    width: 40px;
    height: 40px;
    background-color: transparent;
    color: var(--primary-color);
    border-radius: 50%;
}

.app-header .action-btn img {
    width: 28px;
    height: 28px;
}

.app-header .title-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
}

.app-header .title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-color);
    margin: 0;
}

.app-header .subtitle {
    font-size: 12px;
    color: #888;
    display: flex;
    align-items: center;
    margin-top: 2px;
}

.online-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: var(--online-status-color);
    margin-right: 5px;
}

.app-header .placeholder {
    width: 40px;
}

#home-screen {
    justify-content: space-between;
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease-in-out;
    padding: 50px 0;
}

.time-widget {
    text-align: center;
    padding: 0 20px;
    color: var(--text-color);
}

.time-widget .time {
    font-size: 72px;
    font-weight: 600;
}

.time-widget .date {
    font-size: 18px;
    color: #666;
}

#home-screen.day-mode .time-widget,
#home-screen.day-mode .time-widget .date,
#home-screen.day-mode .app-icon .app-name {
    color: var(--white-color);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
}

.app-grid {
    width: 100%;
    padding: 20px 40px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    justify-content: center;
    align-content: center;
    margin-top: 30px;
}

#home-screen.day-mode .time-widget,
#home-screen.day-mode .time-widget .date,
#home-screen.day-mode .app-icon .app-name {
    color: var(--white-color);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
}

.dock {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px;
    background-color: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    border-radius: var(--border-radius);
    margin: 0 20px;
    min-height: 10px;
    gap: 15px;
}

.app-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    text-decoration: none;
}

.icon-img {
    width: 60px;
    height: 60px;
    border-radius: 15px;
    margin-bottom: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease;
    object-fit: cover;
}

.app-icon:hover .icon-img {
    transform: translateY(-5px);
}

.app-icon .app-name {
    font-size: 12px;
    color: var(--text-color);
    font-weight: 500;
}

.content {
    flex-grow: 1;
    overflow-y: auto;
    padding: 20px;
    position: relative;
}

.placeholder-text {
    text-align: center;
    color: #aaa;
    margin-top: 50px;
}

.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: 100;
    display: none;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
}

.modal-overlay.visible {
    display: flex;
}

.modal-window {
    background: var(--white-color);
    padding: 25px;
    border-radius: var(--border-radius);
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
    width: 85%;
    max-width: 340px;
    animation: slideUp 0.4s ease-out;
}

.modal-window h3 {
    margin-top: 0;
    text-align: center;
    color: var(--primary-color);
}

@keyframes slideUp {
    from {
        transform: translateY(20px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

#edit-group-member-modal,
#create-member-for-group-modal {
    z-index: 102;
}

#edit-group-member-modal .avatar-preview,
#create-member-for-group-modal .avatar-preview {
    width: 80px;
    height: 80px;
}

.context-menu {
    position: fixed;
    z-index: 1000;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    padding: 5px 0;
    animation: fadeIn 0.1s ease;
}

.context-menu-item {
    padding: 10px 20px;
    cursor: pointer;
}

.context-menu-item:hover {
    background-color: #f5f5f5;
}

.context-menu-item.danger {
    color: #e53935;
}

.action-sheet-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: 200;
    display: none;
    align-items: flex-end;
    animation: fadeIn 0.3s ease;
}

.action-sheet-overlay.visible {
    display: flex;
}

.action-sheet {
    background: #f7f7f7;
    width: 100%;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    padding: 10px;
    padding-bottom: calc(10px + env(safe-area-inset-bottom));
    animation: slideUp 0.3s ease-out;
}

.action-sheet-button {
    width: 100%;
    background: white;
    border: none;
    padding: 15px;
    font-size: 16px;
    color: var(--primary-color);
    font-weight: 500;
    cursor: pointer;
    border-radius: 10px;
    margin-bottom: 8px;
}

.action-sheet-button.danger {
    color: #e53935;
}

.action-sheet-button:last-child {
    margin-bottom: 0;
}

#chat-list-screen .content,
#world-book-screen .content {
    padding: 10px 0 0 0;
}

.list-container {
    list-style: none;
    margin: 0;
    padding: 0;
}

.list-item {
    display: flex;
    align-items: center;
    padding: 10px 20px;
    cursor: pointer;
    border-bottom: 1px solid #f0f0f0;
    transition: background-color 0.2s ease;
    position: relative;
}

.list-item:hover {
    background-color: #fdf6f8;
}

.chat-item.pinned {
    background-color: var(--top-pinned-bg);
}

.chat-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 15px;
    object-fit: cover;
    flex-shrink: 0;
    background-color: #eee;
}

.group-avatar {
    border-radius: 10px;
}

.item-details {
    flex-grow: 1;
    overflow: hidden;
}

.item-details-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.item-name {
    font-weight: 600;
    color: var(--text-color);
    font-size: 16px;
}

.item-preview-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 4px;
}

.item-preview {
    font-size: 14px;
    color: #888;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-grow: 1;
}

.pin-badge {
    background-color: var(--primary-color);
    color: white;
    font-size: 10px;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 5px;
    white-space: nowrap;
    flex-shrink: 0;
}

#chat-room-screen {
    background-size: cover;
    background-position: center;
}

#chat-room-screen .content {
    display: flex;
    flex-direction: column;
    padding: 10px;
    padding-bottom: 10px;
    transition: padding-bottom 0.3s ease;
}

#chat-room-screen.multi-select-active .content {
    padding-bottom: 70px;
}

.message-area {
    flex-grow: 1;
    overflow-y: auto;
    padding: 0 10px;
    scroll-behavior: smooth;
}

.message-wrapper {
    display: flex;
    margin-bottom: 12px;
    align-items: flex-start;
    transition: background-color 0.2s;
    flex-direction: column;
}

.message-wrapper.group-message {
    margin-bottom: 18px;
}

.message-wrapper.sent {
    align-items: flex-end;
}

.message-wrapper.received {
    align-items: flex-start;
}

.message-wrapper.system-notification {
    align-items: center;
}

.message-bubble-row {
    display: flex;
    width: 100%;
    align-items: flex-start;
}

.message-wrapper.sent .message-bubble-row {
    flex-direction: row-reverse;
}

.message-wrapper.multi-select-selected {
    background-color: rgba(144, 202, 249, 0.2);
    border-radius: var(--border-radius);
}

.message-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
}

.group-nickname {
    position: absolute;
    top: -15px;
    font-size: 11px;
    color: #888;
    white-space: nowrap;
    width: 70px;
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
}

.message-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    object-fit: cover;
}

.message-time {
    font-size: 9px;
    color: #aaa;
    margin-top: 3px;
}

.message-bubble {
    max-width: 260px;
    padding: 8px 12px;
    border-radius: var(--border-radius);
    word-wrap: break-word;
    line-height: 1.4;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    margin: 0 8px;
    cursor: pointer;
    font-size: 15px;
}

.message-bubble.sent {
    border-bottom-right-radius: 5px;
}

.message-bubble.received {
    border-bottom-left-radius: 5px;
}

.system-notification-bubble {
    background-color: rgba(200, 200, 200, 0.5);
    color: #666;
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 10px;
    text-align: center;
}

.image-bubble {
    max-width: 120px;
    border-radius: var(--border-radius);
    margin: 0 8px;
    padding: 4px;
    background-color: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    cursor: pointer;
}

.image-bubble img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: calc(var(--border-radius) - 4px);
}

.message-wrapper.sent .image-bubble {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .image-bubble {
    border-bottom-left-radius: 5px;
}

.voice-bubble {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-radius: var(--border-radius);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    margin: 0 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    min-width: 90px;
    max-width: 200px;
}

.message-wrapper.sent .voice-bubble {
    border-bottom-right-radius: 5px;
    flex-direction: row-reverse;
}

.message-wrapper.received .voice-bubble {
    border-bottom-left-radius: 5px;
}

.voice-bubble .play-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
}

.voice-bubble .duration {
    font-size: 13px;
    margin: 0 8px;
    white-space: nowrap;
}

.message-wrapper.sent .play-icon {
    transform: scaleX(-1);
}

.voice-transcript {
    font-size: 14px;
    color: #555;
    background-color: rgba(255, 255, 255, 0.7);
    padding: 8px 12px;
    margin-top: 5px;
    margin-left: 54px;
    margin-right: 54px;
    border-radius: 10px;
    line-height: 1.6;
    max-width: calc(100% - 108px);
    display: none;
    animation: fadeIn 0.3s ease;
}

.voice-transcript.active {
    display: block;
}

.message-wrapper.sent .voice-transcript {
    align-self: flex-end;
    margin-right: 54px;
    margin-left: auto;
}

.message-wrapper.received .voice-transcript {
    align-self: flex-start;
    margin-left: 54px;
    margin-right: auto;
}

.pv-card {
    width: 230px;
    aspect-ratio: 1 / 1;
    background-color: #f0f0f0;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    position: relative;
    cursor: pointer;
    margin: 0 8px;
}

.message-wrapper.sent .pv-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .pv-card {
    border-bottom-left-radius: 5px;
}

.pv-card-image-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    transition: opacity 0.5s ease-in-out;
    z-index: 2;
}

.pv-card-image-overlay.hidden {
    opacity: 0;
    pointer-events: none;
}

.pv-card-content {
    padding: 15px;
    height: 100%;
    overflow-y: auto;
    color: var(--text-color);
    line-height: 1.6;
    font-size: 15px;
    background-color: white;
    position: relative;
    z-index: 1;
}

.pv-card-footer {
    background: linear-gradient(to top, rgba(0, 0, 0, 0.6), transparent);
    color: white;
    padding: 20px 10px 8px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 3;
    pointer-events: none;
    transition: opacity 0.5s ease-in-out;
}

.pv-card-footer.hidden {
    opacity: 0;
}

.pv-card-footer svg {
    width: 14px;
    height: 14px;
    fill: white;
    flex-shrink: 0;
}

.transfer-card {
    width: 240px;
    height: auto;
    border-radius: var(--border-radius);
    margin: 0 8px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    color: white;
}

.message-wrapper.sent .transfer-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .transfer-card {
    border-bottom-left-radius: 5px;
    cursor: pointer;
}

.transfer-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-size: cover;
    background-position: center;
    filter: blur(4px);
    transform: scale(1.1);
    z-index: 1;
}

.transfer-card.sent-transfer::before {
    background-image: url('https://i.postimg.cc/sxN893WF/IMG-20250712.png');
}

.transfer-card.received-transfer::before {
    background-image: url('https://i.postimg.cc/FzR8LY7g/IMG-20250712-170703.png');
}

.transfer-card .overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.3);
    z-index: 2;
    transition: background-color 0.5s ease;
}

.transfer-card.received .overlay {
    background-color: rgba(255, 182, 193, 0.4);
}

.transfer-card.returned .overlay {
    background-color: rgba(100, 100, 100, 0.5);
}

.transfer-content {
    position: relative;
    z-index: 3;
    padding: 20px;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

.transfer-title {
    font-size: 14px;
    margin: 0 0 5px 0;
    opacity: 0.9;
}

.transfer-amount {
    font-size: 28px;
    font-weight: bold;
    margin: 0;
}

.transfer-remark {
    font-size: 14px;
    margin-top: 10px;
    opacity: 0.9;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.transfer-status {
    font-size: 12px;
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    opacity: 0.8;
}

/* --- æ‹‰é»‘åŠŸèƒ½æ–°å¢æ ·å¼ --- */
.block-indicator {
    color: #ef5350;
    font-size: 20px;
    font-weight: bold;
    display: none;
    /* é»˜è®¤éšè— */
    align-self: center;
    /* å‚ç›´å±…ä¸­ */
    animation: fadeIn 0.3s;
}

/* --- æ‹‰é»‘åŠŸèƒ½æ ·å¼ (å·²ä¿®æ­£) --- */
.block-indicator {
    color: #ef5350;
    font-size: 20px;
    font-weight: bold;
    display: none;
    /* é»˜è®¤éšè— */
    align-self: center;
    /* å‚ç›´å±…ä¸­ */
    animation: fadeIn 0.3s;
}

/* å½“ç”¨æˆ·(sent)çš„æ¶ˆæ¯åœ¨è¢«AIæ‹‰é»‘æœŸé—´å‘é€æ—¶ï¼Œæ˜¾ç¤ºæ„Ÿå¹å· */
.message-wrapper.user-was-blocked .block-indicator.sent {
    display: block;
}

/* å½“AI(received)çš„æ¶ˆæ¯åœ¨è¢«ç”¨æˆ·æ‹‰é»‘æœŸé—´å‘é€æ—¶ï¼Œæ˜¾ç¤ºæ„Ÿå¹å· */
.message-wrapper.ai-was-blocked .block-indicator.received {
    display: block;
}

/* æ„Ÿå¹å·ä½ç½®è°ƒæ•´ */
.message-wrapper.received .message-bubble-row .block-indicator.received {
    order: 3;
    (ç§»é™¤æˆ–æ³¨é‡Šæ‰æ­¤è¡Œ) */ margin-left: 8px;
    /* å°† margin-right æ”¹ä¸º margin-left */
}

.message-wrapper.sent .message-bubble-row .block-indicator.sent {
    order: 1;
    /* æ–°å¢ï¼šä½¿ç”¨orderå±æ€§æ”¹å˜å…¶åœ¨flexå®¹å™¨ä¸­çš„è§†è§‰é¡ºåº */
    margin-right: 8px;
    /* ä¿®æ”¹ï¼šå°†é—´è·åº”ç”¨åˆ°å³ä¾§ï¼Œä½¿å…¶ä¸æ°”æ³¡åˆ†å¼€ */
}

/* --- é¡¶éƒ¨â€œæ­£åœ¨è¾“å…¥â€çŠ¶æ€çš„åŠ¨ç”»æ•ˆæœ --- */
@keyframes typing-pulse {

    0%,
    100% {
        opacity: 0.6;
    }

    50% {
        opacity: 1;
    }
}

#chat-room-subtitle .typing-status {
    /* åº”ç”¨å‘¼å¸ç¯ä¸€æ ·çš„åŠ¨ç”»æ•ˆæœ */
    animation: typing-pulse 1.8s infinite ease-in-out;
}

/* --- åŠ¨æ€åˆ é™¤æ¨¡å¼ä¸‹çš„æŒ‰é’®æ ·å¼è°ƒæ•´ --- */
#moments-screen.is-delete-mode .app-header #moments-delete-btn {
    color: var(--primary-color);
    font-weight: 600;
}

#moments-screen.is-delete-mode .app-header #moments-delete-btn::before {
    content: "å–æ¶ˆ";
    /* å°†â€œåˆ é™¤â€æ–‡å­—æ›¿æ¢ä¸ºâ€œå–æ¶ˆâ€ */
}

#moments-screen.is-delete-mode .app-header #moments-delete-btn {
    font-size: 0;
    /* éšè—åŸå§‹çš„â€œåˆ é™¤â€æ–‡å­— */
}

/* åº•éƒ¨å¤šé€‰æ“ä½œæ çš„æ ·å¼ */
#moments-multi-select-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    padding: 10px 20px;
    padding-bottom: calc(10px + env(safe-area-inset-bottom));
    border-top: 1px solid #eee;
    z-index: 200;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transform: translateY(100%);
    transition: transform 0.3s ease-out;
}

#moments-multi-select-bar.show {
    transform: translateY(0);
}

#moments-multi-select-bar button {
    padding: 8px 16px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-size: 14px;
}

#moments-multi-select-bar #moments-confirm-delete {
    background-color: #ef5350;
    color: white;
}

#moments-multi-select-bar #moments-cancel-delete {
    background-color: #e0e0e0;
    color: #333;
}

#diary-screen .content {
    padding: 10px;
}

.diary-entry {
    background-color: #fff8fa;
    border-radius: var(--border-radius);
    padding: 15px;
    margin-bottom: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    border-left: 4px solid var(--primary-color);
}

.diary-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f0f0f0;
}

.diary-date {
    font-size: 14px;
    font-weight: 600;
    color: var(--secondary-color);
}

.diary-actions button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px;
    margin-left: 8px;
}

.diary-actions button svg {
    width: 20px;
    height: 20px;
    fill: #aaa;
    transition: fill 0.2s ease, transform 0.2s ease;
}

.diary-actions button:hover svg {
    fill: var(--primary-color);
    transform: scale(1.1);
}

.diary-actions button.favorited svg {
    fill: #fbc02d;
    /* æ”¶è—åçš„é‡‘è‰² */
}

.diary-content {
    font-size: 15px;
    line-height: 1.7;
    color: var(--text-color);
    white-space: pre-wrap;
    /* ä¿ç•™æ—¥è®°ä¸­çš„æ¢è¡Œ */
    word-wrap: break-word;
}

.gift-card {
    width: 230px;
    background-color: #fff;
    border: 2px solid #333;
    border-radius: var(--border-radius);
    box-shadow: 4px 4px 0px #ddd;
    padding: 10px;
    display: flex;
    align-items: center;
    cursor: pointer;
    margin: 0 8px;
    position: relative;
    overflow: hidden;
}

.message-wrapper.sent .gift-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .gift-card {
    border-bottom-left-radius: 5px;
}

.gift-card-icon {
    width: 50px;
    height: 50px;
    margin-right: 15px;
    flex-shrink: 0;
}

.gift-card-text {
    font-size: 16px;
    font-weight: bold;
    color: #333;
    font-family: 'Comic Sans MS', 'Chalkduster', 'Handwriting', cursive;
}

.gift-card-description {
    font-size: 14px;
    color: #555;
    background-color: rgba(240, 240, 240, 0.9);
    padding: 8px 12px;
    margin-top: 5px;
    margin-left: 54px;
    margin-right: 54px;
    border-radius: 10px;
    line-height: 1.6;
    max-width: calc(100% - 108px);
    display: none;
    animation: fadeIn 0.3s ease;
}

.gift-card-description.active {
    display: block;
}

.message-wrapper.sent .gift-card-description {
    align-self: flex-end;
    margin-right: 54px;
    margin-left: auto;
}

.message-wrapper.received .gift-card-description {
    align-self: flex-start;
    margin-left: 54px;
    margin-right: auto;
}

.gift-card-received-stamp {
    position: absolute;
    top: 5px;
    right: 5px;
    font-size: 14px;
    font-weight: bold;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    border-radius: 8px;
    padding: 2px 6px;
    transform: rotate(15deg);
    opacity: 0;
    transition: opacity 0.3s ease;
    font-family: 'Comic Sans MS', 'Chalkduster', 'Handwriting', cursive;
}

.gift-card.received .gift-card-received-stamp {
    opacity: 1;
}

.file-card {
    width: 240px;
    background-color: #fff;
    border: 1px solid #e0e0e0;
    border-radius: var(--border-radius);
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    margin: 0 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.message-wrapper.sent .file-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .file-card {
    border-bottom-left-radius: 5px;
}

.file-card-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
}

.file-card-info {
    overflow: hidden;
    flex-grow: 1;
}

.file-card-name {
    font-size: 15px;
    font-weight: 500;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0 0 4px 0;
}

.file-card-size {
    font-size: 12px;
    color: #888;
    margin: 0;
}

.location-card {
    width: 250px;
    background-color: #fff;
    border: 1px solid #e0e0e0;
    border-radius: var(--border-radius);
    margin: 0 8px;
    overflow: hidden;
    cursor: pointer;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.message-wrapper.sent .location-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .location-card {
    border-bottom-left-radius: 5px;
}

.location-card-info {
    padding: 10px 12px;
    border-bottom: 1px solid #f0f0f0;
}

.location-main {
    font-size: 16px;
    color: #222;
    margin: 0 0 4px 0;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.location-detail {
    font-size: 12px;
    color: #888;
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.location-map {
    width: 100%;
    height: 140px;
    background-size: cover;
    background-position: center;
    background-image: url('https://i.postimg.cc/L8gYhF4Q/share-image-1755433372879-edit-155975507275678.jpg');
    /* Placeholder map image */
}

.load-more-btn {
    background-color: #e0e0e0;
    color: #757575;
    border: none;
    padding: 8px 16px;
    margin: 10px auto;
    border-radius: 15px;
    cursor: pointer;
    display: block;
    font-size: 13px;
    font-weight: 500;
}

.load-more-btn:hover {
    background-color: #d1d1d1;
}

.typing-indicator {
    text-align: center;
    color: #aaa;
    font-style: italic;
    font-size: 14px;
    padding: 10px 0;
    display: none;
}

#sticker-bar {
    flex-shrink: 0;
    padding: 0 10px 5px;
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    overflow-x: auto;
    /* æ–°å¢ï¼šå…è®¸æ¨ªå‘æ»šåŠ¨ */
    /* ä»¥ä¸‹ä¸ºå¯é€‰ä»£ç ï¼Œç”¨äºåœ¨æŸäº›æµè§ˆå™¨ä¸Šéšè—æ»šåŠ¨æ¡ï¼Œä½†ä¿ç•™æ»šåŠ¨åŠŸèƒ½ */
    scrollbar-width: none;
    /* Firefox */
    -ms-overflow-style: none;
    /* IE 10+ */
}




/* --- æ¢å¤å›¾æ ‡æ çš„å·¦å³æ»‘åŠ¨åŠŸèƒ½ --- */
#sticker-bar {
    flex-shrink: 0;
    padding: 5px 10px;
    /* å·¦å³ç•™å‡ºä¸€äº›è¾¹è· */
    display: flex;
    align-items: center;
    gap: 0px;
    /* è®¾ç½®å›¾æ ‡ä¹‹é—´çš„å›ºå®šé—´è· */
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);

    /* æ ¸å¿ƒæ”¹åŠ¨ï¼šå…è®¸Xè½´ï¼ˆæ¨ªå‘ï¼‰æ»šåŠ¨ */
    overflow-x: auto;
    overflow-y: hidden;
    /* ç¦æ­¢å‚ç›´æ–¹å‘æ»šåŠ¨ */

    /* ä»¥ä¸‹ä»£ç æ˜¯ä¸ºäº†åœ¨è§†è§‰ä¸Šéšè—æ»šåŠ¨æ¡ï¼Œä½†ä¿ç•™æ»šåŠ¨åŠŸèƒ½ï¼Œè®©ç•Œé¢æ›´ç¾è§‚ */
    scrollbar-width: none;
    /* Firefox */
    -ms-overflow-style: none;
    /* IE 10+ */
}

#sticker-bar::-webkit-scrollbar {
    display: none;
    /* Chrome, Safari, Opera */
}

#sticker-bar .sticker-bar-btn {
    padding: 5px;
    /* å‡å°æŒ‰é’®çš„å†…è¾¹è·ï¼Œè®©å®ƒæœ¬èº«æ›´å° */
    margin: 0;
    /* ç§»é™¤æ‰€æœ‰æŒ‰é’®å¯èƒ½å­˜åœ¨çš„å¤–è¾¹è· */
    background: none;
    border: none;
    cursor: pointer;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease;
}

#sticker-bar .sticker-bar-btn:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

#sticker-bar .sticker-bar-btn svg {
    width: 24px;
    /* å…³é”®ï¼šé€‚å½“ç¼©å°å›¾æ ‡æœ¬èº«çš„å¤§å°ä»¥é€‚åº”ç©ºé—´ */
    height: 24px;
    fill: #888;
    /* ç¡®ä¿æ‰€æœ‰å›¾æ ‡éƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„é»˜è®¤é¢œè‰² */
}

/* å¦‚æœç‰¹å®šæŒ‰é’®æœ‰é¢å¤–æ ·å¼ï¼Œæ¯”å¦‚èƒŒæ™¯è‰²ï¼Œå¯ä»¥å•ç‹¬è®¾ç½® */
#rollback-btn {
    /* ä¿æŒé»˜è®¤çš„èƒŒæ™¯ï¼Œæˆ–è€…å¯ä»¥è®¾ç½®ä¸€ä¸ªæ›´äº®çš„é¢œè‰² */
    background: rgba(0, 0, 0, 0.03);
    /* ç¨å¾®æœ‰ç‚¹èƒŒæ™¯è‰²ï¼Œä½†ä¿æŒé—´è· */
    border-radius: 50%;
    /* ä¿æŒåœ†å½¢ */
}

#rollback-btn:hover {
    background-color: rgba(0, 0, 0, 0.1);
}

.sticker-bar-btn {
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
}

.sticker-bar-btn svg {
    width: 28px;
    height: 28px;
    fill: #888;
}

#sticker-modal {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 35%;
    max-height: 250px;
    background: #f7f7f7;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
    z-index: 25;
    display: none;
    flex-direction: column;
}

#sticker-modal.visible {
    display: flex;
    animation: slideUp 0.3s ease-out;
}

#sticker-modal .header {
    padding: 10px 15px;
    font-weight: bold;
    color: var(--text-color);
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.sticker-grid {
    flex-grow: 1;
    overflow-y: auto;
    padding: 15px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 15px;
}

/* ===== ğŸ†• è¡¨æƒ…åŒ…å¼¹çª—æ–°æ ·å¼ï¼ˆåˆ†ç»„åŠŸèƒ½ï¼‰===== */
/* è¡¨æƒ…åŒ…å¼¹çª—å¤´éƒ¨ */
.sticker-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 15px;
    border-bottom: 1px solid #eee;
    background: #fff;
    flex-shrink: 0;
}

/* æ ‡ç­¾å®¹å™¨ï¼ˆå¯æ¨ªå‘æ»šåŠ¨ï¼‰ */
.sticker-tabs-container {
    flex: 1;
    overflow-x: auto;
    overflow-y: hidden;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE 10+ */
}

.sticker-tabs-container::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
}

/* æ ‡ç­¾æ  */
.sticker-tabs {
    display: flex;
    gap: 10px;
    padding-right: 10px;
}

/* å•ä¸ªæ ‡ç­¾ */
.sticker-tab {
    padding: 6px 16px;
    border-radius: 20px;
    background: #f0f0f0;
    color: #666;
    font-size: 14px;
    font-weight: 500;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 2px solid transparent;
}

.sticker-tab:hover {
    background: #e5e5e5;
}

.sticker-tab.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* å³ä¸Šè§’èœå•æŒ‰é’® */
.sticker-menu-btn {
    width: 36px;
    height: 36px;
    border: none;
    background: none;
    cursor: pointer;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s ease;
    flex-shrink: 0;
    margin-left: 10px;
}

.sticker-menu-btn:hover {
    background: rgba(0, 0, 0, 0.05);
}

.sticker-menu-btn svg {
    width: 24px;
    height: 24px;
    fill: #666;
}

/* ===== åº•éƒ¨èœå• Action Sheet ===== */
.sticker-menu-action-sheet {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 9999;
    display: none;
    pointer-events: none;
}

.sticker-menu-action-sheet.visible {
    display: block;
    pointer-events: auto;
}

/* åŠé€æ˜èƒŒæ™¯é®ç½© */
.action-sheet-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.sticker-menu-action-sheet.visible .action-sheet-backdrop {
    opacity: 1;
}

/* èœå•å†…å®¹å®¹å™¨ */
.action-sheet-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    padding: 10px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
}

.sticker-menu-action-sheet.visible .action-sheet-content {
    transform: translateY(0);
}

/* èœå•é¡¹ */
.action-sheet-item {
    width: 100%;
    padding: 16px 20px;
    background: white;
    border: none;
    border-radius: 12px;
    margin-bottom: 8px;
    cursor: pointer;
    font-size: 16px;
    color: #333;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.2s ease;
}

.action-sheet-item:hover {
    background: #f5f5f5;
    transform: scale(0.98);
}

.action-sheet-item svg {
    width: 24px;
    height: 24px;
    fill: var(--primary-color);
}

/* å–æ¶ˆæŒ‰é’®ç‰¹æ®Šæ ·å¼ */
.action-sheet-cancel {
    background: white;
    color: #666;
    font-weight: 600;
    justify-content: center;
}

.action-sheet-cancel:hover {
    background: #f0f0f0;
}

/* ===== ğŸ†• è¡¨æƒ…åŒ…åˆ†ç»„æŠ˜å èœå•æ ·å¼ ===== */
.sticker-groups-accordion {
    margin-bottom: 20px;
}

.accordion-header {
    transition: all 0.3s ease;
}

.accordion-header:hover {
    background: linear-gradient(135deg, #fce4ec 0%, #fff8fa 100%) !important;
    box-shadow: 0 2px 8px rgba(233, 30, 99, 0.1);
}

.accordion-header:active {
    transform: scale(0.98);
}

.accordion-arrow {
    transition: transform 0.3s ease;
}

.accordion-content {
    transition: max-height 0.3s ease, padding 0.3s ease;
}

/* åˆ†ç»„å¤é€‰æ¡†æ ‡ç­¾æ ·å¼å¢å¼º */
.sticker-group-checkbox-label {
    transition: all 0.2s ease, transform 0.15s ease;
}

.sticker-group-checkbox-label:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
}

.sticker-group-checkbox-label:active {
    transform: translateY(0);
}

/* ç¡®ä¿å¤é€‰æ¡†å’Œæ–‡å­—å¯¹é½ */
.sticker-group-checkbox {
    flex-shrink: 0;
}

.sticker-group-checkbox + span {
    line-height: 1.4;
}

/* ===== ğŸ†• å¤šé€‰ç®¡ç†æ¨¡å¼æ ·å¼ ===== */
/* åº•éƒ¨æ“ä½œæ  */
.sticker-selection-bar {
    display: none; /* é»˜è®¤éšè— */
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    border-top: 1px solid #eee;
    padding: 10px 15px;
    flex-direction: row;
    align-items: center;
    gap: 10px;
    z-index: 10;
}

#sticker-modal.selection-mode .sticker-selection-bar {
    display: flex; /* é€‰æ‹©æ¨¡å¼ä¸‹æ˜¾ç¤º */
}

#sticker-modal.selection-mode .sticker-grid {
    padding-bottom: 60px; /* ä¸ºæ“ä½œæ ç•™å‡ºç©ºé—´ */
}

.selection-bar-btn {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 8px 10px;
    border: none;
    background: #f0f0f0;
    border-radius: 8px;
    cursor: pointer;
    font-size: 13px;
    color: #333;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.selection-bar-btn:hover {
    background: #e0e0e0;
    transform: translateY(-1px);
}

.selection-bar-btn svg {
    width: 16px;
    height: 16px;
    fill: currentColor;
    flex-shrink: 0;
}

.selection-bar-btn span {
    font-size: 13px;
}

.selection-bar-btn.btn-select-all {
    background: #e8f5e9;
    color: #2e7d32;
}

.selection-bar-btn.btn-select-all:hover {
    background: #c8e6c9;
}

.selection-bar-btn.btn-danger {
    background: #ffebee;
    color: #d32f2f;
}

.selection-bar-btn.btn-danger:hover {
    background: #ffcdd2;
}

.selection-info {
    flex: 1;
    text-align: center;
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

/* è¡¨æƒ…é¡¹å¤é€‰æ¡† */
.sticker-item {
    position: relative;
}

.sticker-item .sticker-checkbox {
    display: none; /* é»˜è®¤éšè— */
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    background: white;
    border: 2px solid #ddd;
    border-radius: 50%;
    cursor: pointer;
    z-index: 5;
    transition: all 0.2s ease;
}

#sticker-modal.selection-mode .sticker-item .sticker-checkbox {
    display: block; /* é€‰æ‹©æ¨¡å¼ä¸‹æ˜¾ç¤º */
}

.sticker-item.selected .sticker-checkbox {
    background: var(--primary-color);
    border-color: var(--primary-color);
}

.sticker-item.selected .sticker-checkbox::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 16px;
    font-weight: bold;
}

/* é€‰ä¸­çŠ¶æ€çš„è¡¨æƒ…é¡¹ */
#sticker-modal.selection-mode .sticker-item.selected {
    opacity: 0.7;
    transform: scale(0.95);
}

#sticker-modal.selection-mode .sticker-item {
    cursor: pointer;
    transition: all 0.2s ease;
}

#sticker-modal.selection-mode .sticker-item:hover {
    transform: scale(1.05);
}

/* ===== åŸæœ‰æ ·å¼ä¿ç•™ ===== */
.sticker-item {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
}

.sticker-item img {
    width: 60px;
    height: 60px;
    object-fit: contain;
}

.sticker-item span {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
    text-align: center;
}

#add-sticker-modal .modal-window {
    max-width: 360px;
}

#sticker-preview {
    width: 100px;
    height: 100px;
    border: 2px dashed #ddd;
    border-radius: 10px;
    margin: 0 auto 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #aaa;
    background-color: #f9f9f9;
}

#sticker-preview img {
    max-width: 100%;
    max-height: 100%;
}

.chat-input-wrapper {
    flex-shrink: 0;
}

.message-input-area {
    display: flex;
    align-items: center;
    padding: 10px;
    padding-bottom: calc(10px + env(safe-area-inset-bottom));
    border-top: 1px solid #eee;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    flex-shrink: 0;
    gap: 10px;
    border-bottom-left-radius: var(--phone-corner-radius);
    border-bottom-right-radius: var(--phone-corner-radius);
    overflow: hidden;
}

.message-input-area input {
    flex-grow: 1;
    border: none;
    padding: 12px;
    border-radius: 18px;
    background-color: #f0f0f0;
}

.message-input-area input:focus {
    outline: none;
}

.message-input-area .icon-btn {
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
}

.message-input-area .icon-btn:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}

.message-input-area .icon-btn svg {
    width: 20px;
    height: 20px;
    fill: currentColor;
}

.message-input-area .icon-btn.send-btn {
    font-size: 18px;
}

#multi-select-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    display: none;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    padding-bottom: calc(10px + env(safe-area-inset-bottom));
    border-top: 1px solid #eee;
    z-index: 20;
    border-bottom-left-radius: var(--phone-corner-radius);
    border-bottom-right-radius: var(--phone-corner-radius);
    animation: slideUp 0.3s ease-out;
}

#multi-select-bar.visible {
    display: flex;
}

.settings-sidebar {
    position: absolute;
    top: 0;
    right: -100%;
    width: 80%;
    height: 100%;
    background: #fff;
    box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
    transition: right 0.4s ease-in-out;
    z-index: 101;
    display: flex;
    flex-direction: column;
}

.settings-sidebar.open {
    right: 0;
}

.settings-sidebar .header {
    padding: 15px;
    border-bottom: 1px solid #eee;
    font-weight: bold;
    text-align: center;
    color: var(--primary-color);
}

.settings-sidebar .content {
    padding: 20px;
    overflow-y: auto;
    flex-grow: 1;
}

.settings-sidebar .form-group textarea {
    height: 100px;
    resize: vertical;
}

.settings-sidebar .avatar-setting {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

.settings-sidebar .avatar-preview {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--primary-color);
    cursor: pointer;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    color: var(--secondary-color);
    font-weight: 600;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #fce4ec;
    border-radius: 10px;
    background-color: #fff;
    transition: border-color 0.3s;
    font-family: var(--font-family);
    font-size: 14px;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--primary-color);
}

.form-group.radio-group {
    display: flex;
    gap: 20px;
    align-items: center;
}

.form-group.radio-group label {
    margin-bottom: 0;
}

.btn {
    width: 100%;
    padding: 15px;
    border-radius: 10px;
    border: none;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    text-align: center;
}

.btn-primary {
    background-color: var(--primary-color);
    color: var(--white-color);
}

.btn-primary:hover {
    background-color: var(--secondary-color);
    box-shadow: 0 4px 15px rgba(255, 128, 171, 0.5);
}

label.btn-primary {
    color: var(--white-color) !important;
}

.btn-small {
    padding: 8px 16px;
    font-size: 14px;
    width: auto;
}

.btn-secondary {
    background-color: var(--accent-color);
    color: var(--white-color);
    margin-bottom: 15px;
}

.btn-secondary:hover {
    background-color: #64b5f6;
    box-shadow: 0 4px 15px rgba(144, 202, 249, 0.5);
}

.btn-neutral {
    background-color: #bdbdbd;
    color: var(--white-color);
}

.btn-neutral:hover {
    background-color: #9e9e9e;
}

.btn-danger {
    background-color: #ef5350;
    color: white;
}

.btn .spinner {
    display: none;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255, 255, 255, 0.5);
    border-top-color: var(--white-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

.btn.loading .spinner {
    display: block;
}

.btn.loading .btn-text {
    display: none;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.wallpaper-preview {
    width: 100%;
    aspect-ratio: 9 / 16;
    max-height: 200px;
    /* ä¿®æ”¹ï¼šå°†æœ€å¤§é«˜åº¦ä» 400px ç¼©å°åˆ° 300px */
    border-radius: var(--border-radius);
    margin-bottom: 15px;
    /* ä¿®æ”¹ï¼šå°†åº•éƒ¨é—´è·ä» 25px ç¼©å°åˆ° 15px */
    background-size: cover;
    background-position: center;
    border: 3px dashed var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--secondary-color);
    font-style: italic;
    background-color: #fff8fa;
}

.toast {
    position: absolute;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 15px;
    font-size: 14px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s, visibility 0.5s;
    z-index: 1000;
}

.toast.show {
    opacity: 1;
    visibility: visible;
}

#world-book-selection-modal,
#invite-member-modal,
#group-recipient-selection-modal {
    z-index: 102;
}

#world-book-selection-modal .modal-window,
#invite-member-modal .modal-window,
#group-recipient-selection-modal .modal-window {
    width: 90%;
    max-width: 380px;
}

#world-book-selection-list,
#invite-member-selection-list,
#group-recipient-selection-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 40vh;
    overflow-y: auto;
}

.world-book-select-item,
.invite-member-select-item,
.group-recipient-select-item {
    display: flex;
    align-items: center;
    padding: 12px 5px;
    border-bottom: 1px solid #f0f0f0;
}

.world-book-select-item:last-child,
.invite-member-select-item:last-child,
.group-recipient-select-item:last-child {
    border-bottom: none;
}

.world-book-select-item input[type="checkbox"],
.invite-member-select-item input[type="checkbox"],
.group-recipient-select-item input[type="checkbox"] {
    margin-right: 15px;
    width: 20px;
    height: 20px;
}

.world-book-select-item label,
.invite-member-select-item label,
.group-recipient-select-item label {
    font-weight: 500;
    color: var(--text-color);
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
}

.invite-member-select-item img,
.group-recipient-select-item img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

/* --- Group Chat Specific Styles --- */
.member-selection-list {
    list-style: none;
    padding: 0;
    margin: 15px 0;
    max-height: 40vh;
    overflow-y: auto;
}

.member-selection-item {
    display: flex;
    align-items: center;
    padding: 10px 5px;
    border-bottom: 1px solid #f0f0f0;
}

.member-selection-item:last-child {
    border-bottom: none;
}

.member-selection-item input[type="checkbox"] {
    margin-right: 15px;
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.member-selection-item img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 10px;
}

.member-selection-item label {
    font-weight: 500;
    color: var(--text-color);
}

#group-settings-sidebar .group-avatar-setting {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
}

#group-settings-sidebar .group-avatar-preview {
    width: 60px;
    height: 60px;
    border-radius: 10px;
    object-fit: cover;
    border: 2px solid var(--primary-color);
    cursor: pointer;
}

#group-settings-sidebar .group-members-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: 15px;
    margin-top: 10px;
}

#group-settings-sidebar .group-member,
#group-settings-sidebar .add-member-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
}

#group-settings-sidebar .group-member img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 5px;
    border: 2px solid #eee;
}

#group-settings-sidebar .add-member-btn .add-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px dashed #ccc;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: #ccc;
    margin-bottom: 5px;
    transition: all 0.2s ease;
}

#group-settings-sidebar .add-member-btn:hover .add-icon {
    color: var(--primary-color);
    border-color: var(--primary-color);
}

#group-settings-sidebar .group-member span,
#group-settings-sidebar .add-member-btn span {
    font-size: 12px;
    text-align: center;
    color: var(--text-color);
}

#customize-screen .icon-custom-item {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f0f0f0;
}

#customize-screen .icon-custom-item:last-child {
    border-bottom: none;
}

#customize-screen .icon-preview {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    object-fit: cover;
    flex-shrink: 0;
}

#customize-screen .icon-details {
    flex-grow: 1;
}

#customize-screen .icon-details p {
    margin: 0 0 8px 0;
    font-weight: 600;
}

#customize-screen .icon-details input {
    width: calc(100% - 70px);
}

#customize-screen .reset-icon-btn {
    background: #e0e0e0;
    color: #555;
    border: none;
    border-radius: 8px;
    padding: 8px 10px;
    font-size: 12px;
    cursor: pointer;
    margin-left: 10px;
}

/* --- Tutorial Screen Styles --- */
.tutorial-item {
    margin-bottom: 15px;
    border: 1px solid #fce4ec;
    border-radius: 12px;
    overflow: hidden;
    background-color: #fff8fa;
}

.tutorial-header {
    padding: 12px 18px;
    font-weight: 600;
    color: var(--secondary-color);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.tutorial-header::after {
    content: 'â–¼';
    font-size: 12px;
    transition: transform 0.3s ease;
}

.tutorial-item.open .tutorial-header::after {
    transform: rotate(180deg);
}

.tutorial-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease-in-out, padding 0.5s ease;
    padding: 0 10px;
}

.tutorial-item.open .tutorial-content {
    padding: 10px 10px;
    /* A large value to ensure it expands to fit the content */
    max-height: 5000px;
}

.tutorial-content img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    display: block;
}

/* --- Voice Call Styles --- */
.sticker-bar-btn#voice-call-btn {
    display: none;
    /* Initially hidden, shown only in private chats */
}

#voice-call-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    z-index: 300;
    display: none;
    flex-direction: column;
    /* ä¿®æ”¹: ä¸å†å‚ç›´å±…ä¸­ï¼Œæ”¹ä¸ºä»é¡¶éƒ¨å¼€å§‹æ’åˆ—å…ƒç´  */

    align-items: center;
    color: white;
    text-align: center;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

#voice-call-overlay.visible {
    display: flex;
}

.call-avatar-large {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 20px;
    border: 4px solid rgba(255, 255, 255, 0.5);
    /* ä¿®æ”¹: å¢åŠ é¡¶éƒ¨å¤–è¾¹è·ï¼Œè®©å¤´åƒä¸ä¼šç´§è´´å±å¹•é¡¶éƒ¨ */
    margin-top: 40px;
    flex-shrink: 0;
    /* é˜²æ­¢åœ¨flexå¸ƒå±€ä¸­è¢«å‹ç¼© */
}

.call-name {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 10px;
    flex-shrink: 0;
}

.call-status {
    font-size: 16px;
    color: #ccc;
    min-height: 24px;
    flex-shrink: 0;
}

/* æ¥ç”µ/å»ç”µæ—¶çš„æŒ‰é’®ç»„æ ·å¼ä¿æŒä¸å˜ */
.call-button-group {
    position: absolute;
    bottom: 80px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-around;
    align-items: center;
}

.call-button {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    background: none;
    border: none;
    color: white;
}

.call-button .icon-wrapper {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
}

.call-button svg {
    width: 36px;
    height: 36px;
    fill: white;
}

.call-button.decline .icon-wrapper {
    background-color: #ef5350;
}

.call-button.accept .icon-wrapper {
    background-color: #4CAF50;
}

/* --- é€šè¯ä¸­ç•Œé¢çš„æ ¸å¿ƒä¿®æ”¹ --- */
/* ã€è¯·ç”¨ä¸‹é¢è¿™æ®µä¿®æ­£åçš„ä»£ç æ›¿æ¢ä¸Šé¢çš„ä»£ç ã€‘ */
#active-call-view {
    display: none;
    flex-direction: column;
    width: 100%;
    flex: 1;
    /* ä¿®æ­£ï¼šä½¿ç”¨flex: 1ç®€å†™å±æ€§ï¼Œç¡®ä¿å®¹å™¨èƒ½å¼ºåŠ›å æ®æ‰€æœ‰å¯ç”¨å‚ç›´ç©ºé—´ */
    min-height: 0;
    /* ä¿ç•™ï¼šè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„Flexboxå¸ƒå±€æŠ€å·§ï¼Œé˜²æ­¢å†…éƒ¨èŠå¤©æ¡†æº¢å‡º */
}

/* éšè—ä¹‹å‰ç‰ˆæœ¬æ·»åŠ çš„ã€ç°åœ¨ä¸éœ€è¦çš„é¡¶éƒ¨å›ºå®šheader */
#active-call-header {
    display: none !important;
}

/* æ–‡å­—èŠå¤©é¢æ¿ï¼ˆå›¾ç‰‡ä¸­æ©™è‰²æ¡†åŒºåŸŸï¼‰ */
#call-transcript-area {
    flex-grow: 1;
    /* å æ® #active-call-view å†…çš„æ‰€æœ‰å¯ç”¨å‚ç›´ç©ºé—´ */
    overflow-y: auto;
    /* å½“å†…å®¹è¶…å‡ºæ—¶ï¼Œå…è®¸æ»šåŠ¨ */
    padding: 10px;
    margin-top: 15px;
    /* ä¸é¡¶éƒ¨çš„çŠ¶æ€è®¡æ—¶å™¨ä¿æŒä¸€å®šé—´è· */
    margin-bottom: 15px;
    /* ä¸ä¸‹æ–¹çš„æŒ‚æ–­æŒ‰é’®ä¿æŒä¸€å®šé—´è· */
    font-size: 15px;
    line-height: 1.7;
    -webkit-overflow-scrolling: touch;
    /* ä¼˜åŒ–åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ»šåŠ¨ä½“éªŒ */
    text-align: left;
    /* èŠå¤©å†…å®¹å·¦å¯¹é½ï¼Œæ›´æ˜“äºé˜…è¯» */
}

.call-transcript-line {
    margin-bottom: 12px;
}

.call-transcript-line .action {
    color: #aaa;
    font-style: italic;
}

.call-transcript-line .dialog {
    color: #fff;
}

/* åº•éƒ¨æ“ä½œåŒºï¼ˆæŒ‚æ–­æŒ‰é’®å’Œè¾“å…¥æ¡†ï¼‰ */
#hangup-button-container {
    position: static;
    /* ç§»é™¤ç»å¯¹å®šä½ï¼Œä½¿å…¶æˆä¸ºflexå¸ƒå±€çš„ä¸€éƒ¨åˆ† */
    padding: 10px 0;
    flex-shrink: 0;
    /* é˜²æ­¢è¢«å‹ç¼© */
}

#call-input-area {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    width: 100%;
    flex-shrink: 0;
}

#call-input {
    flex-grow: 1;
    border: none;
    padding: 12px;
    border-radius: 18px;
    background-color: rgba(255, 255, 255, 0.2);
    color: white;
}

#call-input::placeholder {
    color: #ccc;
}

#send-call-message-btn {
    background: var(--primary-color);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    color: white;
    font-size: 18px;
    flex-shrink: 0;
}

/* --- éŸ³ä¹æ’­æ”¾å™¨å¼¹çª—æ ·å¼ --- */
#music-player-modal .modal-window {
    width: 90%;
    max-width: 360px;
    padding: 0;
    /* ç§»é™¤å†…è¾¹è·ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰å¸ƒå±€ */
    overflow: hidden;
    background: #fafafa;
}

.music-player-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.music-player-header .song-title {
    font-size: 16px;
    font-weight: 600;
    margin: 0;
}

.music-player-header .share-btn {
    width: 24px;
    height: 24px;
    fill: #888;
}

.music-player-body {
    padding: 25px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.music-album-art {
    width: 180px;
    height: 180px;
    border-radius: 15px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    margin-bottom: 25px;
}

.music-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 25px;
    margin-top: 20px;
}

.music-controls button {
    background: none;
    border: none;
    cursor: pointer;
}

.music-controls .play-btn svg {
    width: 60px;
    height: 60px;
}

.music-controls .side-btn svg {
    width: 32px;
    height: 32px;
}

.music-extra-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 15px 25px;
}

.music-extra-controls button {
    background: none;
    border: none;
    cursor: pointer;
}

.music-extra-controls svg {
    width: 26px;
    height: 26px;
    fill: #555;
}

.lyrics-panel-placeholder {
    height: 60px;
    /* æ­Œè¯é¢æ¿å ä½ */
    width: 100%;
    background: #f0f0f0;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #aaa;
    margin-top: 15px;
}

/* --- æ­Œè¯é¢æ¿æ ·å¼ (æ–°æ·»åŠ ) --- */
.lyrics-panel {
    width: 100%;
    height: 60px;
    /* å›ºå®šé«˜åº¦ */
    margin-top: 15px;
    overflow: hidden;
    /* éšè—å®¹å™¨å¤–éƒ¨çš„å†…å®¹ */
    text-align: center;
    position: relative;
    -webkit-mask-image: linear-gradient(to bottom,
            transparent 0%,
            black 25%,
            black 75%,
            transparent 100%);
    mask-image: linear-gradient(to bottom,
            transparent 0%,
            black 25%,
            black 75%,
            transparent 100%);
}

.lyrics-panel-inner {
    transition: transform 0.5s ease-out;
    /* å¹³æ»‘æ»šåŠ¨æ•ˆæœ */
}

.lyric-line {
    margin: 0;
    padding: 4px 0;
    font-size: 15px;
    color: #888;
    line-height: 1.5;
    transition: all 0.3s ease;
}

.lyric-line.active {
    color: var(--primary-color);
    font-weight: 600;
    font-size: 16px;
    transform: scale(1.05);
}

/* --- éŸ³ä¹åˆ†äº«å¡ç‰‡æ ·å¼ --- */
.music-card {
    width: 240px;
    background-color: #fff;
    border-radius: var(--border-radius);
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    margin: 0 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    border: 1px solid #eee;
}

.message-wrapper.sent .music-card {
    border-bottom-right-radius: 5px;
}

.message-wrapper.received .music-card {
    border-bottom-left-radius: 5px;
}

.music-card-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    border-radius: 8px;
    object-fit: cover;
}

.music-card-info {
    overflow: hidden;
    flex-grow: 1;
}

.music-card-title {
    font-size: 15px;
    font-weight: 500;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0 0 4px 0;
}

.music-card-artist {
    font-size: 12px;
    color: #888;
    margin: 0;
}

/* === å¯ç¼©æ”¾å˜é‡ï¼ˆä½œç”¨åŸŸï¼šä»…èŠå¤©å®¤å±å¹•ï¼‰ === */
#chat-room-screen {
    --bubble-scale: 1;
    --bubble-font-base: 15px;
}

#chat-room-screen .message-area {
    font-size: calc(var(--bubble-font-base) * var(--bubble-scale));
}

#chat-room-screen .message-bubble {
    font-size: 1em !important;
    padding: 0.533em 0.8em !important;
    max-width: calc(260px * var(--bubble-scale)) !important;
}

#chat-room-screen .system-notification-bubble {
    font-size: 0.8em !important;
    padding: 0.4em 0.67em !important;
}

#chat-room-screen .voice-bubble {
    font-size: 1em !important;
    padding: 0.533em 0.8em !important;
    min-width: calc(90px * var(--bubble-scale)) !important;
    max-width: calc(200px * var(--bubble-scale)) !important;
}

#chat-room-screen .voice-bubble .duration {
    font-size: 0.87em !important;
}

#chat-room-screen .image-bubble {
    max-width: calc(120px * var(--bubble-scale)) !important;
}

#chat-room-screen .pv-card {
    width: calc(230px * var(--bubble-scale)) !important;
    font-size: 1em !important;
}

#chat-room-screen .transfer-card {
    width: calc(240px * var(--bubble-scale)) !important;
    font-size: 1em !important;
}

#chat-room-screen .gift-card {
    width: calc(230px * var(--bubble-scale)) !important;
    font-size: 1em !important;
}

#chat-room-screen .gift-card-description,
#chat-room-screen .voice-transcript {
    font-size: 0.93em !important;
    line-height: 1.6;
}

#chat-room-screen .message-bubble,
#chat-room-screen .voice-bubble,
#chat-room-screen .pv-card,
#chat-room-screen .transfer-card,
#chat-room-screen .gift-card {
    border-radius: calc(var(--border-radius) * var(--bubble-scale)) !important;
}

/* DEBUG FIXES: ensure active screen uses flex and phone-screen is positioned */
.phone-screen {
    position: relative !important;
}

.screen {
    display: none !important;
}

.screen.active {
    display: flex !important;
}

.modal-overlay {
    position: absolute !important;
}


/* --- moment image description card (injected) --- */
.moment-image-desc-card {
    background: linear-gradient(135deg, rgba(238, 156, 167, 0.3), rgba(255, 221, 225, 0.3));
    /* åŠé€æ˜ç²‰è‰²æ¸å˜èƒŒæ™¯ */
    border-radius: 10px;
    padding: 12px 14px;
    margin-top: 6px;
    color: #fff;
    position: relative;
    overflow: hidden;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    /* min-height: 86px; */
    display: flex;
    align-items: center;
    cursor: pointer;
    backdrop-filter: blur(10px);
    /* å…³é”®ï¼šæ¯›ç»ç’ƒæ¨¡ç³Šæ•ˆæœ */
    -webkit-backdrop-filter: blur(10px);
    /* å…¼å®¹ Safari */
    border: 1px solid rgba(255, 255, 255, 0.3);
    /* å¢åŠ ç»ç’ƒè´¨æ„Ÿè¾¹æ¡† */
}


/* === è¦†ç›–ï¼šä»…æ”¹å˜å¡ç‰‡å¤–æ¡†ä¸é…è‰²ï¼ˆä¿ç•™åŸæ–‡ä»¶å¡ç‰‡å½¢çŠ¶/å¸ƒå±€/æ ‡é¢˜ï¼‰ === */
.moment-image-desc-card {
    /* ä¸æ”¹ width/height/border-radius/padding ç­‰å¸ƒå±€å±æ€§ï¼Œä¿éšœåŸæ ·å¼å½¢çŠ¶ä¸å˜ */
    border: 6px solid #ffffff;
    box-shadow: 0 6px 20px rgba(10, 10, 20, 0.06);
    background: transparent !important;
}

/* å†…å±‚æµ…ç°é¢æ¿ï¼ˆåªåœ¨å­˜åœ¨å†…å±‚ç±»æ—¶è¦†ç›–èƒŒæ™¯è‰²ï¼‰ */
.moment-image-desc-card .inner {
    background: #eef0f3 !important;
}

/* å°†å‚è€ƒå›¾ä¸­â€œæ ‡é¢˜è‰²â€åº”ç”¨åˆ°å›¾ç‰‡æè¿°æ–‡å­—ä¸Šï¼š#66676b */
.moment-image-desc-card .desc-content,
.moment-image-desc-card .description,
.moment-image-desc-card .image-desc {
    color: #66676b !important;
}

/* å°å±å¾®è°ƒï¼ˆä¸æ”¹å˜å¸ƒå±€ï¼‰ */
@media (max-width: 420px) {
    .moment-image-desc-card {
        box-shadow: 0 4px 14px rgba(10, 10, 20, 0.05);
    }
}

/*
.moment-image-desc-card::before {
content: '';
position: absolute;
inset: -12px;
background: inherit;
filter: blur(10px);
transform: scale(1.08);
z-index: 1;
opacity: 0.95;
}
*/
.moment-image-desc-card .desc-content {
    position: relative;
    z-index: 2;
    font-style: italic;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.45);
    line-height: 1.4;
    font-size: 13px;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    /* -webkit-line-clamp: 4; */
    overflow: hidden;
    word-break: break-word;
    /* max-height: calc(1.4em * 4); */
}

@media (max-width: 420px) {
    .moment-image-desc-card {
        padding: 9px;
        /* min-height: 72px; */
    }

    .moment-image-desc-card .desc-content {
        /* -webkit-line-clamp: 3; */
    }
}

/* --- é’±åŒ…åŠŸèƒ½æ–°å¢æ ·å¼ --- */
.wallet-balance-card {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    padding: 25px;
    border-radius: var(--border-radius);
    text-align: center;
    margin-bottom: 30px;
    box-shadow: 0 8px 25px rgba(255, 128, 171, 0.3);
}

.wallet-balance-label {
    margin: 0 0 10px 0;
    font-size: 16px;
    opacity: 0.9;
}

.wallet-balance-amount {
    margin: 0;
    font-size: 42px;
    font-weight: 600;
}

.wallet-actions-list {
    background-color: #fff;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.wallet-action-item {
    padding: 18px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 16px;
    cursor: pointer;
    border-bottom: 1px solid #f0f0f0;
}

.wallet-action-item:last-child {
    border-bottom: none;
}

.wallet-action-item:hover {
    background-color: #fdf6f8;
}

/* äº¤æ˜“æ˜ç»†æ ·å¼ */
.transaction-item {
    display: flex;
    justify-content: space-between;
    padding: 12px 5px;
    border-bottom: 1px solid #f0f0f0;
}

.transaction-details {
    display: flex;
    flex-direction: column;
}

.transaction-description {
    font-weight: 500;
    color: #333;
}

.transaction-timestamp {
    font-size: 12px;
    color: #999;
    margin-top: 4px;
}

.transaction-amount {
    font-weight: bold;
    font-size: 16px;
}

.transaction-amount.expense {
    color: #333;
}

.transaction-amount.income {
    color: #4CAF50;
    /* æ”¶å…¥ç”¨ç»¿è‰²è¡¨ç¤º */
}

/* --- HTMLå°å‰§åœºæ˜¾ç¤ºé«˜åº¦è‡ªé€‚åº”ä¿®å¤ --- */
.ai-generated-theater {
    width: auto;
    /* å®½åº¦ç”±å†…å®¹å†³å®šï¼Œä½†ä¸èƒ½è¶…è¿‡çˆ¶å®¹å™¨ */
    max-width: 100%;
    /* ä¿æŒæœ€å¤§å®½åº¦é™åˆ¶ */
    height: auto;
    /* å…³é”®ï¼šé«˜åº¦è‡ªåŠ¨é€‚åº”å†…éƒ¨å†…å®¹ */
    min-height: 20px;
    /* è®¾ç½®ä¸€ä¸ªæœ€å°é«˜åº¦ï¼Œé¿å…ç©ºå†…å®¹æ—¶å¡Œé™· */
    display: inline-block;
    /* æ”¹ä¸ºè¡Œå†…å—å…ƒç´ ï¼Œä½¿å…¶èƒ½æ›´å¥½åœ°åŒ…è£¹å†…å®¹ */
    overflow: visible;
    /* å…è®¸å†…éƒ¨çš„ç»å¯¹å®šä½æˆ–é˜´å½±å…ƒç´ ç¨å¾®æº¢å‡º */
    box-sizing: border-box;
}

/* ç¡®ä¿AIç”Ÿæˆçš„å†…éƒ¨å…ƒç´ ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤º */
.ai-generated-theater>* {
    max-width: 100%;
    box-sizing: border-box;
}

/* ç¡®ä¿å°å‰§åœºåœ¨å‘é€æ–¹å’Œæ¥æ”¶æ–¹ä½ç½®æ­£ç¡® */
.message-wrapper.sent .ai-generated-theater {
    align-self: flex-end;
}

.message-wrapper.received .ai-generated-theater {
    align-self: flex-start;
}

/* --- AIç©ºé—´å¯¹è¯æ°”æ³¡æ ·å¼ä¿®å¤ä¸ç¾åŒ– (AI Space Bubble Fix & Styling) --- */

/* æ ¸å¿ƒï¼šä¸ºâ€œå¯¹æ–¹â€çš„æ¶ˆæ¯ï¼ˆreceivedï¼‰å®šä¹‰æ ·å¼ */
#ai-message-area .message-wrapper.received .message-bubble {
    /* 1. å¼ºåˆ¶ä¸ºå¯¹æ–¹æ¶ˆæ¯æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„ç°è‰²æ°”æ³¡èƒŒæ™¯ï¼Œè§£å†³â€œæ²¡æœ‰æ°”æ³¡â€çš„é—®é¢˜ */
    background-color: #f0f0f0;
    color: #333;

    /* 2. å°†æ°”æ³¡è®¾ç½®ä¸ºæ¤­åœ†å½¢ï¼Œå¹¶ç§»é™¤å°–è§’ */
    border-radius: 20px;
    /* æ‚¨å¯ä»¥è°ƒæ•´è¿™ä¸ªå€¼æ¥æ”¹å˜æ¤­åœ†çš„åœ†æ¶¦ç¨‹åº¦ */
}

/* ç¡®ä¿ä¸»è§†è§’AIè‡ªå·±å‘é€çš„æ¶ˆæ¯ï¼ˆsentï¼‰ä¹Ÿæœ‰é»˜è®¤çš„ç²‰è‰²æ°”æ³¡ï¼ˆä»¥é˜²ä¸‡ä¸€ï¼‰ */
#ai-message-area .message-wrapper.sent .message-bubble {
    background-color: var(--primary-color);
    color: white;
    border-radius: 20px;
    border-bottom-right-radius: 5px;
    /* ä¾ç„¶å¯ä»¥ä¿ç•™è‡ªå·±æ¶ˆæ¯çš„å°–è§’ï¼Œå¦‚æœæƒ³å»æ‰ä¹Ÿæ”¹æˆ20pxå³å¯ */
}

/* å¯¹äºHTMLå°å‰§åœºç­‰ç‰¹æ®Šå†…å®¹ï¼Œç¡®ä¿å®ƒä»¬åœ¨AIç©ºé—´ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤º */
#ai-message-area .ai-generated-theater {
    max-width: 90%;
    margin: 0 8px;
}

/* --- ç¾¤å¤´è¡”å®šä½ä¿®æ­£ä»£ç  --- */

/* ç”¨äºåŒ…è£¹å¤´è¡”å’Œæ˜µç§°çš„å®¹å™¨ */
.group-message-header {
    display: flex;
    align-items: center;
    margin-bottom: 4px;
    /* å¤´è¡”ä¸æ°”æ³¡çš„å‚ç›´é—´è· */
    padding: 0;
    /* ç§»é™¤å›ºå®šçš„å·¦å³å†…è¾¹è·ï¼Œä»¥ä¾¿çµæ´»å¯¹é½ */
    position: absolute;
    /* ä½¿ç”¨ç»å¯¹å®šä½è¿›è¡Œç²¾ç¡®å®šä½ */
    top: 0;
    width: calc(100% - 44px);
    /* é™åˆ¶å®½åº¦ï¼Œé¿å…æº¢å‡º */
}

/* AIæ¶ˆæ¯ (å¯¹æ–¹): å¤´è¡”/æ˜µç§°æ˜¾ç¤ºåœ¨å¤´åƒå³ä¾§ï¼Œæ°”æ³¡ä¸Šæ–¹ */
.message-wrapper.received .group-message-header {
    justify-content: flex-start;
    /* å†…å®¹é å·¦ */
    left: 44px;
    /* è·ç¦»å·¦ä¾§ = å¤´åƒå®½åº¦(36px) + é—´è·(8px) */
}

/* ç”¨æˆ·æ¶ˆæ¯ (è‡ªå·±): å¤´è¡”/æ˜µç§°æ˜¾ç¤ºåœ¨å¤´åƒå·¦ä¾§ï¼Œæ°”æ³¡ä¸Šæ–¹ */
.message-wrapper.sent .group-message-header {
    justify-content: flex-end;
    /* å†…å®¹é å³ */
    right: 44px;
    /* è·ç¦»å³ä¾§ = å¤´åƒå®½åº¦(36px) + é—´è·(8px) */
}

/* æ¶ˆæ¯æ°”æ³¡è¡Œéœ€è¦å‘ä¸‹ç§»åŠ¨ï¼Œä¸ºå¤´è¡”ç•™å‡ºç©ºé—´ */
.group-message .message-bubble-row {
    margin-top: 18px;
    /* ç•™å‡ºè¶³å¤Ÿçš„å‚ç›´ç©ºé—´ */
}

/* ç¾¤æˆå‘˜æ˜µç§°çš„æ ·å¼ */
.group-sender-name {
    font-size: 12px;
    color: #888;
}

/* ç¾¤å¤´è¡”å¾½ç« çš„æ ·å¼ */
.group-title-badge {
    display: inline-block;
    padding: 2px 6px;
    font-size: 9px;
    font-weight: bold;
    border-radius: 4px;
    color: #fff;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    /* é»˜è®¤é¢œè‰² */
    vertical-align: middle;
    margin-right: 4px;
    /* å¾½ç« å’Œæ˜µç§°ä¹‹é—´çš„é—´è· */
}

/* ç”¨æˆ·æ¶ˆæ¯ä¸­ï¼Œå¤´è¡”åœ¨æ˜µç§°å³ä¾§ï¼Œéœ€è¦è°ƒæ•´é—´è· */
.message-wrapper.sent .group-title-badge {
    margin-right: 0;
    /* ç§»é™¤å³è¾¹è· */
    margin-left: 4px;
    /* å¢åŠ å·¦è¾¹è· */
}

/* ç¡®ä¿æ—§çš„æ ·å¼è¢«æ­£ç¡®è¦†ç›– */
.group-nickname {
    position: static;
    width: auto;
    text-align: left;
    overflow: visible;
    text-overflow: clip;
}

/* ä¸åŒç­‰çº§å¤´è¡”çš„é¢œè‰² (ä¿æŒä¸å˜) */
.group-title-badge.lv26 {
    background: linear-gradient(135deg, #ffaf7b, #ff8c5a);
    color: #fff;
}

.group-title-badge.lv12 {
    background: linear-gradient(135deg, #d4a4f2, #b57be5);
    color: #fff;
}

.group-title-badge.lv11 {
    background: linear-gradient(135deg, #ffc0cb, #ff9eaf);
    color: #c72c48;
}

.group-title-badge.lv10 {
    background: linear-gradient(135deg, #cfd9df, #e2ebf0);
    color: #5d707f;
}

/* --- ä¸–ç•Œä¹¦åˆ†ç±»åŠŸèƒ½æ ·å¼ --- */
.world-book-category {
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    background-color: #fff8fa;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    cursor: pointer;
    background-color: #fff;
    border-bottom: 1px solid #f0f0f0;
}

.category-header:hover {
    background-color: #fdf6f8;
}

.category-name {
    font-weight: 600;
    font-size: 16px;
    color: var(--secondary-color);
}

.category-toggle-icon {
    transition: transform 0.3s ease;
    font-weight: bold;
    color: var(--secondary-color);
}

.world-book-category.collapsed .category-toggle-icon {
    transform: rotate(-90deg);
}

.category-book-list {
    list-style: none;
    margin: 0;
    padding: 0;
    transition: max-height 0.5s ease-in-out, padding 0.5s ease;
    max-height: 5000px;
    /* A large value to ensure it can contain many items */
    overflow: hidden;
}

.world-book-category.collapsed .category-book-list {
    max-height: 0;
}

/* åˆ†ç±»ä¸‹çš„ä¸–ç•Œä¹¦æ¡ç›®æ ·å¼å¾®è°ƒ */
.category-book-list .list-item {
    border-top: 1px solid #f0f0f0;
    border-bottom: none;
}

/* --- æ–°å¢ï¼šå¤´åƒæ¡†åŠŸèƒ½æ ·å¼ --- */

/* ç”¨äºåŒ…è£¹å¤´åƒå’Œå¤´åƒæ¡†çš„å®¹å™¨ */
.avatar-container,
.avatar-container-setting {
    position: relative;
    display: inline-block;
    flex-shrink: 0;
    /* ç¡®ä¿å®¹å™¨å¤§å°ä¸å†…éƒ¨å¤´åƒä¸€è‡´ */
    line-height: 0;
}

.avatar-container-setting {
    width: 60px;
    height: 60px;
}

.message-info .avatar-container {
    width: 36px;
    height: 36px;
}

/* è®¾ç½®é¢æ¿ä¸­çš„â€œæ˜Ÿæ˜Ÿâ€æŒ‰é’® */
.avatar-frame-btn {
    padding: 5px 10px !important;
    font-size: 16px !important;
    line-height: 1 !important;
    min-width: auto !important;
    align-self: center;
    /* å‚ç›´å±…ä¸­å¯¹é½ */
}

/* å¤´åƒæ¡†å›¾ç‰‡æ ·å¼ (å°ºå¯¸å·²è°ƒæ•´) */
.avatar-frame {
    position: absolute;
    /* æ ¸å¿ƒä¿®æ”¹ï¼šé€šè¿‡è´Ÿè¾¹è·å°†å…¶æ”¾å¤§å¹¶é‡æ–°å±…ä¸­ */
    width: 125%;
    /* å°†å®½åº¦è®¾ä¸ºå¤´åƒçš„1.25å€ */
    height: 125%;
    /* å°†é«˜åº¦è®¾ä¸ºå¤´åƒçš„1.25å€ */
    top: -16.5%;
    /* å‘ä¸Šç§»åŠ¨å¤šå‡ºé«˜åº¦çš„ä¸€åŠ */
    left: -12.5%;
    /* å‘å·¦ç§»åŠ¨å¤šå‡ºå®½åº¦çš„ä¸€åŠ */

    pointer-events: none;
    /* å…è®¸ç‚¹å‡»ç©¿é€åˆ°ä¸‹é¢çš„å¤´åƒ */
    z-index: 2;
}

/* è°ƒæ•´è®¾ç½®é¡¹çš„é—´è·ä»¥å®¹çº³æŒ‰é’® */
.avatar-setting {
    gap: 8px;
}

/* å¤´åƒæ¡†é€‰æ‹©é¢æ¿æ ·å¼ */
#avatar-frame-modal .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

#avatar-frame-modal h3 {
    margin: 0;
}

#avatar-frame-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 15px;
    max-height: 50vh;
    overflow-y: auto;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 8px;
    min-height: 100px;
}

.frame-item {
    position: relative;
    width: 80px;
    height: 80px;
    cursor: pointer;
    border: 3px solid transparent;
    border-radius: 12px;
    transition: all 0.2s ease-in-out;
    padding: 2px;
}

.frame-item.selected {
    border-color: var(--primary-color);
    transform: scale(1.05);
}

.frame-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
}

.frame-item .delete-frame-btn {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 22px;
    height: 22px;
    background: #ef5350;
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 14px;
    line-height: 22px;
    text-align: center;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s;
    z-index: 5;
}

.frame-item:hover .delete-frame-btn {
    opacity: 1;
}

#avatar-frame-modal .modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

/* --- å•†åŸè´­ç‰©æµç¨‹ & è´­ç‰©è½¦æ ·å¼ --- */
.purchase-flow-modal {
    padding: 15px;
}

.close-purchase-modal-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 24px;
    color: #999;
    cursor: pointer;
}

.purchase-product-info {
    display: flex;
    align-items: flex-end;
    gap: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f0f0f0;
}

.purchase-product-info img {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    object-fit: cover;
}

.purchase-product-info p {
    color: #e53935;
    font-size: 20px;
    font-weight: bold;
    margin: 0 0 5px 0;
}

.purchase-product-info h4 {
    font-size: 16px;
    margin: 0;
}

.purchase-section {
    padding: 15px 0;
}

.purchase-section h5 {
    margin: 0 0 10px 0;
    font-size: 14px;
    color: #555;
}

#recipient-selection-list {
    max-height: 25vh;
    overflow-y: auto;
}

#recipient-selection-list .list-item {
    padding: 10px 5px;
}

.style-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.style-option-btn {
    padding: 8px 15px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    color: #333;
    border-radius: 15px;
    cursor: pointer;
}

.style-option-btn.active {
    border-color: var(--primary-color);
    background-color: #fff0f5;
    color: var(--primary-color);
}

.quantity-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.quantity-selector {
    display: flex;
    align-items: center;
}

.quantity-selector .quantity-btn {
    width: 28px;
    height: 28px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    font-size: 18px;
    cursor: pointer;
}

.quantity-selector input {
    width: 50px;
    height: 28px;
    text-align: center;
    border: 1px solid #ddd;
    border-left: none;
    border-right: none;
}

/* è´­ç‰©è½¦å•†å“é¡¹æ ·å¼ */
.cart-item {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
    display: flex;
    gap: 15px;
}

.cart-item-image {
    width: 90px;
    height: 90px;
    border-radius: 8px;
    object-fit: cover;
    flex-shrink: 0;
}

.cart-item-details {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

.cart-item-title {
    font-size: 14px;
    margin: 0 0 8px 0;
}

.cart-item-price {
    font-size: 16px;
    font-weight: bold;
    color: #e53935;
    margin-top: auto;
}

.cart-item-actions {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: space-between;
}

.cart-item-actions .to-pay-btn {
    padding: 6px 12px;
    font-size: 13px;
    background-color: #e53935;
    color: white;
}

.cart-payment-countdown {
    font-size: 12px;
    color: #e53935;
}

/* å‘é€åˆ°èŠå¤©ä¸­çš„å•†å“åç‰‡æ ·å¼ */
.product-delivery-card {
    width: 240px;
    background-color: #fff;
    border-radius: var(--border-radius);
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 0 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    border: 1px solid #eee;
}

.message-wrapper.sent .product-delivery-card {
    border-bottom-right-radius: 5px;
}

.product-delivery-card-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    border-radius: 8px;
    object-fit: cover;
}

.product-delivery-card-info {
    overflow: hidden;
    flex-grow: 1;
}

.product-delivery-card-title {
    font-size: 15px;
    font-weight: 500;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0 0 4px 0;
}

.delivery-countdown-display {
    font-size: 12px;
    color: #e53935;
    font-weight: bold;
    margin: 0;
}

/* --- å•†å“è¯¦æƒ…é¡µåº•éƒ¨æ“ä½œæ ä¿®å¤ --- */
#product-detail-screen {
    display: flex;
    flex-direction: column;
}

#product-detail-screen .content {
    flex-grow: 1;
    padding-bottom: 80px;
    /* ä¸ºåº•éƒ¨æ“ä½œæ ç•™å‡ºè¶³å¤Ÿç©ºé—´ */
}

.detail-footer-nav {
    position: absolute;
    /* æ”¹ä¸ºç»å¯¹å®šä½ */
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 10;
    height: auto;
    /* é«˜åº¦è‡ªé€‚åº” */
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-top: 1px solid #eee;
    padding: 8px;
    display: flex;
    gap: 8px;
}

.detail-footer-nav .action-btn {
    flex: 1;
    border: none;
    border-radius: 20px;
    font-size: 14px;
    /* é€‚å½“å‡å°å­—ä½“ */
    font-weight: 600;
    cursor: pointer;
    padding: 12px 5px;
    /* è°ƒæ•´å†…è¾¹è· */
    background-color: #ffcdd2;
    color: var(--primary-color);
}

.detail-footer-nav .action-btn.primary {
    background-color: var(--primary-color);
    color: white;
}

/* æ”¶è—æŒ‰é’®æ¿€æ´»æ ·å¼ */
.detail-footer-nav .action-btn.liked {
    background-color: #fff0f5;
    color: var(--primary-color);
    border: 1px solid var(--primary-color);
}

/* --- æ–°å¢ï¼šAIç©ºé—´åŠŸèƒ½æ ·å¼ --- */
#ai-space-photos-album-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 5px;
    padding: 5px;
}

.ai-photo-item {
    aspect-ratio: 1 / 1;
    background-color: #e9e9e9;
    border-radius: 8px;
    padding: 10px;
    font-size: 13px;
    color: #555;
    line-height: 1.5;
    overflow: hidden;
    cursor: pointer;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 5;
    /* æœ€å¤šæ˜¾ç¤º5è¡Œæ–‡å­— */
}

.ai-transaction-item .item-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}

.ai-transaction-amount {
    font-weight: bold;
}

.ai-transaction-amount.expense {
    color: #d32f2f;
}

.ai-transaction-amount.income {
    color: #388e3c;
}

/* --- æ–°ç‰ˆè´­ç‰©è½¦æ ·å¼ --- */

#cart-item-list-container {
    padding-bottom: 120px !important;
    /* ä¸ºåº•éƒ¨ç»“ç®—æ å’Œå¯¼èˆªæ ç•™å‡ºç©ºé—´ */
}

.cart-store-group {
    background-color: #fff;
    border-radius: 12px;
    margin: 0 10px 10px;
    padding: 10px;
}

.cart-store-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding-bottom: 10px;
    border-bottom: 1px solid #f5f5f5;
    font-size: 14px;
    font-weight: bold;
}

.cart-item {
    padding: 15px 0 15px 10px;
    display: flex;
    gap: 10px;
    align-items: center;
    border-bottom: 1px solid #f5f5f5;
}

.cart-store-group .cart-item:last-child {
    border-bottom: none;
}

/* é€‰æ‹©æ¡†æ ·å¼ */
.cart-item-selector {
    width: 22px;
    height: 22px;
    border: 2px solid #ccc;
    border-radius: 50%;
    background-color: #fff;
    cursor: pointer;
    flex-shrink: 0;
    position: relative;
    transition: all 0.2s ease;
}

/* é€‰ä¸­æ—¶çš„æ ·å¼ */
.cart-item.selected .cart-item-selector,
.select-all-container.selected .cart-item-selector {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
}

.cart-item.selected .cart-item-selector::after,
.select-all-container.selected .cart-item-selector::after {
    content: 'âœ“';
    color: white;
    font-size: 14px;
    font-weight: bold;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.cart-item-image {
    width: 80px;
    height: 80px;
}

.cart-item-details .cart-item-price {
    margin-top: 8px;
    /* ä»·æ ¼å’Œæ ‡é¢˜æ‹‰å¼€è·ç¦» */
}

.cart-item-actions {
    margin-left: auto;
    /* å°†æ”¯ä»˜æŒ‰é’®æ¨åˆ°æœ€å³ä¾§ */
}

/* åº•éƒ¨ç»“ç®—æ  */
.cart-checkout-bar {
    position: absolute;
    bottom: 60px;
    /* åœ¨ä¸»å¯¼èˆªä¹‹ä¸Š */
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    padding: 10px 15px;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 150;
}

.select-all-container {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
}

.checkout-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

#cart-total-price {
    font-size: 16px;
    font-weight: bold;
    color: #e53935;
}

#cart-checkout-btn {
    padding: 8px 18px;
    border-radius: 18px;
}

#cart-delete-selected-btn {
    border-radius: 18px;
}

/* ç®¡ç†æ¨¡å¼åˆ‡æ¢ */
#mall-cart-screen.manage-mode #cart-checkout-btn,
#mall-cart-screen.manage-mode #cart-total-price {
    display: none;
}

#mall-cart-screen:not(.manage-mode) #cart-delete-selected-btn {
    display: none;
}


/* ç¡®ä¿ phone-screen åšä¸ºè£åˆ‡å®¹å™¨ */
.phone-screen {
    position: relative !important;
    overflow: hidden !important;
    /* é˜²æ­¢å­å…ƒç´ è·‘å‡ºå¯è§†åŒº */
}

/* æŠŠæ‰€æœ‰ screen ç»Ÿä¸€åšç»å¯¹é“ºæ»¡ï¼Œè¿™æ ·åˆ‡æ¢åªå½±å“å¯è§æ€§ï¼Œä¸ä¼šæ”¹å˜å¸ƒå±€æµ */
.screen {
    position: absolute !important;
    inset: 0;
    /* top:0; right:0; bottom:0; left:0; */
    display: none !important;
    flex-direction: column;
    -webkit-overflow-scrolling: touch;
}

/* æ¿€æ´»çš„ screen å¯è§ */
.screen.active {
    display: flex !important;
}

/* ç¡®ä¿ screen ä¸­çš„ä¸»å†…å®¹åŒºå•ç‹¬å¯æ»šåŠ¨ï¼ˆä¸ä¼šæŠŠæ•´ä¸ª screen æ¨å‡ºï¼‰ */
/* --- ä¿®å¤ï¼šèŠå¤©è¾“å…¥æ¡†å› å¸ƒå±€é—®é¢˜æ— æ³•ç‚¹å‡»çš„è¡¥ä¸ (æœ€ç»ˆç‰ˆ) --- */
#chat-room-screen .content {
    flex-grow: 1;
    /* ä¿æŒï¼šè®©å…¶å¡«å……å¯ç”¨ç©ºé—´ */
    overflow-y: auto;
    /* ä¿æŒï¼šå†…å®¹è¶…å‡ºæ—¶å¯æ»šåŠ¨ */
    height: auto;
    /* æ–°å¢/ç¡®è®¤ï¼šé«˜åº¦ç”±flexboxå†³å®šï¼Œä¸æ˜¯å›ºå®šçš„100% */
    min-height: 0;
    /* å…³é”®ä¿®å¤ï¼šé˜²æ­¢å†…éƒ¨å†…å®¹æ’‘ç ´flexå®¹å™¨ */
    display: flex;
    /* ç¡®ä¿å†…éƒ¨å…ƒç´ ä¹Ÿä½¿ç”¨flexå¸ƒå±€ */
    flex-direction: column;
    /* å‚ç›´æ’åˆ—æ¶ˆæ¯ */
    padding: 10px;
    /* ä¿æŒåŸæœ‰çš„å†…è¾¹è· */
    padding-bottom: 10px;
    /* ä¿æŒåŸæœ‰çš„å†…è¾¹è· */
}

/* ä¸ºåŠ¨æ€é¡µé¢çš„åº•éƒ¨å¯¼èˆªæ é¢„ç•™ç©ºé—´ */
#moments-screen .content {
    padding-bottom: 88px !important;
}

/* é˜²æ­¢ moments é¡µé¢è¢«æŸäº› transform/translate æ¨å‡ºè§†çª—ï¼ˆä¿åº•ï¼‰ */
#moments-screen {
    transform: none !important;
    will-change: auto !important;
}

/* --- è°ƒæ•´å³ä¸Šè§’æŒ‰é’®ç»„çš„é—´è· --- */
.app-header .action-btn-group {
    gap: 2px;
    /* å°†æŒ‰é’®é—´çš„é»˜è®¤é—´è·ä» 10px å‡å°åˆ° 4px */
}

/* --- æ–°çš„éŸ³ä¹æ’­æ”¾å™¨å°éƒ¨ä»¶æ ·å¼ï¼ˆå”±ç‰‡æœºï¼‰ --- */
.record-player-widget {
    /*
     * ===============================================
     * == åœ¨è¿™é‡Œè‡ªå®šä¹‰æ‚¨çš„å›¾ç‰‡ URL ==
     * ===============================================
     * --record-sleeve-image: æ›¿æ¢ä¸ºæ‚¨æƒ³è¦çš„æ–¹å½¢â€œå”±ç‰‡å°å¥—â€å›¾ç‰‡ã€‚
     * --record-label-image:  æ›¿æ¢ä¸ºæ‚¨æƒ³è¦çš„åœ†å½¢â€œå”±ç‰‡æ ‡ç­¾â€å›¾ç‰‡ã€‚
    */
    --record-sleeve-image: url('https://i.postimg.cc/KzC3q4w3/image.png');
    /* ç¤ºä¾‹ï¼šå¸¦çŒ«çˆªçš„åŠé€æ˜å°é¢ */
    --record-label-image: url('https://i.postimg.cc/nzP9sgxr/chan-125.png');
    /* ç¤ºä¾‹ï¼šåŠ¨æ¼«å¤´åƒ */

    /* ä½¿ç”¨å˜é‡æ§åˆ¶æ•´ä½“å¤§å° */
    --music-widget-scale: 1.3;

    position: relative;
    width: calc(130px * var(--music-widget-scale));
    height: calc(130px * var(--music-widget-scale));
    margin: 20px auto 15px auto;
    cursor: pointer;
}

.record-player-widget .record-sleeve {
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    width: 100%;
    height: 100%;
    background-image: var(--record-sleeve-image);
    background-size: cover;
    background-position: center;
    background-color: rgba(255, 255, 255, 0.7);
    /* å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶çš„åº•è‰² */
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.record-player-widget .vinyl-record {
    position: absolute;
    top: 50%;
    right: -20%;
    /* è®©å”±ç‰‡ä»å³ä¾§ä¼¸å‡º */
    transform: translateY(-50%);
    width: 100%;
    height: 100%;
    background-color: #1a1a1a;
    /* é»‘èƒ¶å”±ç‰‡çš„é¢œè‰² */
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    transition: transform 0.4s ease;
}

.record-player-widget:hover .vinyl-record {
    transform: translateY(-50%) translateX(8px);
    /* é¼ æ ‡æ‚¬æµ®æ—¶å”±ç‰‡å‘å³ç§»åŠ¨ */
}

.record-player-widget .record-label {
    width: 70%;
    height: 70%;
    background-image: var(--record-label-image);
    background-size: cover;
    background-position: center;
    background-color: #fff;
    /* å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶çš„åº•è‰² */
    border-radius: 50%;
    border: 2px solid #333;
    /* æ ‡ç­¾å‘¨å›´çš„æ·±è‰²ç¯ */
}

/* --- è´­ç‰©è½¦ç®¡ç†æ¨¡å¼åˆ‡æ¢æ ·å¼ --- */

/* å½“è¿›å…¥ç®¡ç†æ¨¡å¼æ—¶ï¼Œéšè—â€œåˆè®¡â€å’Œâ€œå»ç»“ç®—â€æŒ‰é’® */
#mall-cart-screen.manage-mode .checkout-info {
    display: none;
}

/* å½“è¿›å…¥ç®¡ç†æ¨¡å¼æ—¶ï¼Œæ˜¾ç¤ºâ€œåˆ é™¤â€æŒ‰é’® */
#mall-cart-screen.manage-mode #cart-delete-selected-btn {
    display: inline-flex;
    /* æˆ–è€… block, flex ç­‰ï¼Œæ ¹æ®æ‚¨çš„æŒ‰é’®æ ·å¼ */
    border-radius: 18px;
    /* ä¿æŒæ ·å¼ç»Ÿä¸€ */
}

/* --- æ–°å¢ï¼šæ”¯ä»˜ç¡®è®¤é¡µé¢æ ·å¼ --- */
.payment-section {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
}

.address-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    cursor: pointer;
}

.address-section .recipient {
    font-size: 16px;
    margin: 0 0 5px;
}

.address-section .address {
    color: #666;
    margin: 0;
}

.payment-item-card {
    display: flex;
    gap: 10px;
    padding: 10px 0;
    border-bottom: 1px solid #f5f5f5;
}

.payment-item-card:last-child {
    border-bottom: none;
}

.payment-item-card img {
    width: 70px;
    height: 70px;
    border-radius: 8px;
}

.payment-item-card .item-info {
    flex-grow: 1;
}

.payment-item-card .item-name {
    font-size: 14px;
    margin: 0;
}

.payment-item-card .item-price {
    font-size: 14px;
    font-weight: bold;
    margin-top: 8px;
}

.payment-methods .method-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 0;
    cursor: pointer;
}

.payment-methods .method-item.selected::after {
    content: 'âœ“';
    color: var(--primary-color);
    font-size: 20px;
    margin-left: auto;
}

.payment-methods .method-item img {
    width: 24px;
    height: 24px;
}

.payment-footer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background: #fff;
    border-top: 1px solid #eee;
}

.payment-footer .total-price {
    color: #e53935;
    font-size: 18px;
    font-weight: bold;
}

#confirm-final-payment-btn {
    padding: 10px 30px;
    border-radius: 20px;
}

/* --- æ–°å¢ï¼šä»£ä»˜è¯·æ±‚å¡ç‰‡æ ·å¼ --- */
.payment-request-card {
    width: 240px;
    border-radius: var(--border-radius);
    margin: 0 8px;
    background: linear-gradient(135deg, #FFC107, #FF9800);
    color: white;
    padding: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.payment-request-title {
    font-size: 14px;
    opacity: 0.9;
}

.payment-request-amount {
    font-size: 32px;
    font-weight: bold;
    margin: 5px 0;
}

.payment-request-desc {
    font-size: 13px;
    margin-bottom: 15px;
}

.payment-request-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.payment-request-actions button {
    flex: 1;
    border-radius: 8px;
    padding: 8px;
}

.payment-request-status {
    font-weight: bold;
    text-align: center;
    margin-top: 10px;
}

/* --- æ–°å¢ï¼šç‰©æµç•Œé¢æ ·å¼ --- */
.logistics-item {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
}

.logistics-header {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    margin-bottom: 10px;
}

.logistics-status {
    color: var(--primary-color);
    font-weight: bold;
}

.logistics-body {
    display: flex;
    gap: 10px;
    align-items: center;
}

.logistics-body img {
    width: 80px;
    height: 80px;
    border-radius: 8px;
}

.logistics-info .item-name {
    font-weight: 500;
}

.logistics-info .eta {
    font-size: 12px;
    color: #888;
    margin-top: 5px;
}

/* --- æ–°å¢ï¼šè‡ªå®šä¹‰å•†å“åŠŸèƒ½æ ·å¼ --- */
.special-product-fields {
    display: none;
    /* é»˜è®¤éšè— */
    border-left: 3px solid var(--primary-color);
    padding-left: 15px;
    margin-top: 15px;
}

.special-product-fields.visible {
    display: block;
    /* å½“è¢«å‹¾é€‰æ—¶æ˜¾ç¤º */
}

/* --- å¿ƒçµç¾ç»Š - æ„¿æœ›æ¸…å•æ ·å¼ --- */
#bond-wishlist-container .list-item {
    display: block;
    /* è¦†ç›–é»˜è®¤çš„flexå¸ƒå±€ */
    padding: 15px;
}

.wish-item {
    display: flex;
    align-items: center;
    gap: 15px;
}

.wish-checkbox {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
    accent-color: var(--primary-color);
}

.wish-item .item-details {
    transition: opacity 0.3s ease;
}

.wish-item.completed .item-name {
    text-decoration: line-through;
    color: #aaa;
}

.wish-item.completed .item-details {
    opacity: 0.6;
}

/* --- å¿ƒçµç¾ç»Š - æ‹ç«‹å¾—ç…§ç‰‡æ–‡å­—æº¢å‡ºä¿®å¤ --- */
.bond-photo-back {
    overflow-y: auto;
    /* æ ¸å¿ƒä¿®å¤ï¼šå½“å†…å®¹è¶…å‡ºæ—¶ï¼Œå…è®¸å‚ç›´æ»šåŠ¨ */
    justify-content: flex-start;
    align-items: flex-start;
    text-align: left;
    padding: 12px;
}

/* --- å¿ƒçµç¾ç»Š - äº¤æ¢æ—¥è®°æ ·å¼ --- */
#diary-exchange-list-container {
    padding: 10px;
}

.diary-exchange-pair {
    background-color: #fff;
    border-radius: 16px;
    margin-bottom: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
    overflow: hidden;
}

.diary-exchange-entry {
    padding: 15px;
}

.entry-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
}

.entry-header img {
    width: 24px;
    height: 24px;
    border-radius: 50%;
}

.entry-header .author-name {
    font-weight: bold;
    color: var(--secondary-color);
}

.entry-content {
    font-size: 15px;
    line-height: 1.7;
    white-space: pre-wrap;
    padding-left: 32px;
    /* å¯¹é½å¤´åƒä¸‹çš„å†…å®¹ */
}

.entry-image {
    width: calc(100% - 32px);
    margin-left: 32px;
    margin-top: 10px;
    border-radius: 8px;
    object-fit: cover;
}

.ai-reply {
    background-color: #fff8fa;
    border-top: 1px dashed #fce4ec;
}

/* --- å¿ƒçµç¾ç»Š - äº¤æ¢æ—¥è®° V2.0 æ ·å¼ --- */
#diary-exchange-list-container {
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    /* å¢åŠ æ—¥è®°æœ¬ä¹‹é—´çš„é—´è· */
}

.diary-book {
    perspective: 1200px;
    height: 220px;
    /* è®¾å®šæ—¥è®°æœ¬çš„é«˜åº¦ */
}

.diary-book-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    cursor: pointer;
}

.diary-book.is-flipped .diary-book-inner {
    transform: rotateY(180deg);
}

.diary-book-cover,
.diary-book-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    background-size: cover;
    background-position: center;
    overflow: hidden;
}

.diary-book-cover {
    background-color: #fce4ec;
    /* é»˜è®¤å°é¢é¢œè‰² */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 15px;
    color: white;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.cover-date {
    font-size: 12px;
    font-weight: bold;
    align-self: flex-start;
}

.cover-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
}

.cover-authors {
    font-size: 13px;
    align-self: flex-end;
}

.diary-book-back {
    transform: rotateY(180deg);
    background-color: #fff8fa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    color: var(--secondary-color);
    padding: 20px;
    text-align: center;
}

/* å¼¹çª—æŸ¥çœ‹å™¨æ ·å¼ */
#diary-viewer-content .diary-exchange-entry {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px dashed #eee;
}

#diary-viewer-content .diary-exchange-entry:last-child {
    border-bottom: none;
    margin-bottom: 0;
}


/* z-index and stacking safety to ensure bottom nav and modals stay on top */
.screen {
    z-index: 0 !important;
}

.screen.active {
    z-index: 1 !important;
}

.bottom-nav {
    z-index: 200 !important;
}

/* ensure bottom nav overlays feed */
.modal-overlay,
.action-sheet-overlay,
.context-menu {
    z-index: 300 !important;
}

#moments-screen {
    z-index: 0 !important;
}

/* keep moments below nav/modals by default */
/* --- æ–°ä»£ç å¼€å§‹ --- */

/* --- æ¢å¤ï¼šè®ºå›é¡µé¢é¡¶éƒ¨å¯¼èˆªæ é®æŒ¡å†…å®¹ --- */
#forum-screen .content,
#forum-thread-screen .content {
    padding-top: 0;
    /* ä¿®æ­£ï¼šç§»é™¤é¡¶å†…è¾¹è·ï¼Œå› ä¸ºæˆ‘ä»¬å°†è®©å†…éƒ¨å…ƒç´ è‡ªå·±å®šä½ */
}

.home-profile-header {
    width: calc(100% - 40px);
    /* å·¦å³ç•™20pxè¾¹è· */
    margin: 0 auto;
    /* å±…ä¸­ */
    position: relative;
    background-color: var(--white-color);
    border-radius: 18px;
    /* ç»Ÿä¸€çš„åœ†è§’ */
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.07);
    /* ç»Ÿä¸€çš„é˜´å½± */
    overflow: visible;
    /* å…è®¸å¤´åƒæº¢å‡º */
}

/* --- æ–°å¢ï¼šè®ºå›åˆ—è¡¨ç‹¬ç«‹æ»šåŠ¨åŒºåŸŸ --- */
#thread-list-container,
#thread-content-container {
    position: absolute;
    top: 55px;
    /* ä»æ ‡é¢˜æ ï¼ˆçº¦55pxé«˜ï¼‰çš„ä¸‹æ–¹å¼€å§‹ */
    bottom: 68px;
    /* åœ¨åº•éƒ¨å¯¼èˆªæ ï¼ˆçº¦68pxé«˜ï¼‰çš„ä¸Šæ–¹ç»“æŸ */
    left: 0;
    right: 0;
    overflow-y: auto;
    /* å…è®¸è¿™ä¸ªåŒºåŸŸè‡ªå·±å‚ç›´æ»šåŠ¨ */
    padding: 10px;
    /* ä¸ºå†…å®¹å¢åŠ ä¸€äº›å†…è¾¹è·ï¼Œé¿å…è´´è¾¹ */
}

/* --- æ–°å¢ç»“æŸ --- */
.home-hero {
    height: 160px;
    background-color: #f0f0f0;
    background-size: cover;
    background-position: center;
    border-radius: 18px 18px 0 0;
    /* åªç»™é¡¶éƒ¨è®¾ç½®åœ†è§’ */
}

.home-avatar-wrap {
    position: absolute;
    top: 160px;
    /* å®šä½åœ¨èƒŒæ™¯å›¾çš„ä¸‹è¾¹ç¼˜ */
    left: 50%;
    transform: translate(-50%, -50%);
    /* ç²¾ç¡®å±…ä¸­ */
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 4px solid var(--white-color);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    z-index: 5;
}

#home-profile-avatar {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.home-info-card {
    padding: 50px 20px 20px;
    /* é¡¶éƒ¨ç•™å‡ºå¤´åƒç©ºé—´ï¼Œåº•éƒ¨ç¼©å°é—´è· */
    text-align: center;
}

.home-profile-name {
    font-size: 20px;
    font-weight: 600;
    margin: 0 0 5px 0;
}

.home-profile-signature {
    font-size: 14px;
    color: #888;
    margin: 0;
}

#home-screen .main-content-area {
    margin-top: -5px;
    /* ç¡®ä¿ä¸å¡ç‰‡åº•éƒ¨æœ‰10pxé—´è· */
}

/* === æ ·å¼ç»“æŸ === */
/* START: ä¸»å±å¹•ç¿»é¡µæ ·å¼ */
#home-container {
    padding: 0;
    justify-content: flex-start;
    overflow: hidden;
}

.home-page-wrapper {
    width: 200%;
    height: 100%;
    display: flex;
    transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
}

.home-page {
    width: 50%;
    height: 100%;
    flex-shrink: 0;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.home-page-indicator {
    position: absolute;
    bottom: 80px;
    /* æ ¹æ®ä½ çš„dockæ é«˜åº¦å¾®è°ƒ */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 8px;
    z-index: 20;
}

.home-page-indicator .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.2);
    transition: background-color 0.3s;
}

.home-page-indicator .dot.active {
    background-color: var(--primary-color);
}

#home-screen.day-mode~.home-page-indicator .dot {
    background-color: rgba(255, 255, 255, 0.4);
}

#home-screen.day-mode~.home-page-indicator .dot.active {
    background-color: #fff;
}

/* END: ä¸»å±å¹•ç¿»é¡µæ ·å¼ */

/* START: æ¸²æŸ“å™¨åº”ç”¨æ ·å¼ */
.renderer-layout {
    display: flex;
    height: 100%;
    padding: 0;
}

.renderer-sidebar {
    width: 120px;
    flex-shrink: 0;
    background-color: #fff8fa;
    border-right: 1px solid #fce4ec;
    overflow-y: auto;
}

.renderer-sidebar .list-item {
    padding: 15px 10px;
    border-bottom-color: #fce4ec;
    text-align: center;
}

.renderer-sidebar .list-item.active {
    background-color: var(--primary-color);
    color: white;
}

.renderer-main {
    flex-grow: 1;
    overflow-y: auto;
    padding: 10px;
}

.renderer-main .list-item {
    display: block;
    padding: 12px 15px;
}

.rule-name {
    font-weight: 600;
}

.rule-regex {
    font-size: 13px;
    color: #888;
    margin-top: 4px;
    font-family: monospace;
}

.char-binding-list {
    max-height: 150px;
    overflow-y: auto;
    border: 1px solid #eee;
    padding: 10px;
    border-radius: 8px;
    background-color: #f9f9f9;
}

.char-binding-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}

/* END: æ¸²æŸ“å™¨åº”ç”¨æ ·å¼ */
/* START: æ¸²æŸ“å™¨å¼¹çª—è¡¥å……æ ·å¼ */
.regex-flags-container {
    display: flex;
    gap: 15px;
    margin-top: 8px;
    font-size: 13px;
}

.regex-flags-container label,
.scope-options label {
    display: flex;
    align-items: center;
    gap: 5px;
}

.renderer-options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

/* END: æ¸²æŸ“å™¨å¼¹çª—è¡¥å……æ ·å¼ */
/* START: æ¸²æŸ“å™¨é¢æ¿å°ºå¯¸ã€å­—å·ä¸æ»šåŠ¨ä¼˜åŒ– */

/* 1. é™åˆ¶å¼¹çª—æœ€å¤§é«˜åº¦ï¼Œå¹¶å¯ç”¨flexå¸ƒå±€ä»¥ä¾¿å†…å®¹æ»šåŠ¨ */
#edit-renderer-rule-modal .modal-window {
    max-height: 85vh;
    /* é™åˆ¶æœ€å¤§é«˜åº¦ä¸ºè§†çª—çš„85% */
    display: flex;
    flex-direction: column;
}

/* 2. è®©è¡¨å•å†…å®¹åŒºåŸŸå¯æ»šåŠ¨ */
#edit-renderer-rule-form {
    overflow-y: auto;
    /* æ ¸å¿ƒï¼šå½“å†…å®¹è¶…å‡ºæ—¶ï¼Œæ­¤åŒºåŸŸå‡ºç°å‚ç›´æ»šåŠ¨æ¡ */
    flex-grow: 1;
    /* å æ®æ‰€æœ‰å¯ç”¨å‚ç›´ç©ºé—´ */
    padding: 5px 15px 5px 5px;
    /* å¾®è°ƒå†…è¾¹è·ï¼Œä¸ºæ»šåŠ¨æ¡ç•™å‡ºç©ºé—´ */
    margin-right: -10px;
    /* è´Ÿå¤–è¾¹è·è®©æ»šåŠ¨æ¡æ›´è´´è¿‘è¾¹ç¼˜ï¼Œè§†è§‰æ•ˆæœæ›´å¥½ */
}

/* 3. ç¼©å°æ‰€æœ‰UIå…ƒç´ çš„å­—å·å’Œé—´è·ï¼Œä½¿å…¶æ›´ç´§å‡‘ */
#edit-renderer-rule-modal h3 {
    font-size: 18px;
    /* ç¼©å°æ ‡é¢˜å­—å· */
    margin-bottom: 15px;
    flex-shrink: 0;
    /* é˜²æ­¢æ ‡é¢˜åœ¨flexå¸ƒå±€ä¸­è¢«å‹ç¼© */
}

#edit-renderer-rule-modal .form-group {
    margin-bottom: 12px;
    /* å‡å°è¡¨å•é¡¹ä¹‹é—´çš„å‚ç›´é—´è· */
}

#edit-renderer-rule-modal .form-group label {
    font-size: 14px;
    /* ç¼©å°æ ‡ç­¾æ–‡å­—å¤§å° */
    color: var(--primary-color);
    /* å°†æ ‡ç­¾é¢œè‰²ç»Ÿä¸€ä¸ºä¸»é¢˜ç²‰è‰² */
    margin-bottom: 6px;
}

#edit-renderer-rule-modal .form-group input[type="text"],
#edit-renderer-rule-modal .form-group textarea {
    font-size: 14px;
    /* ç¼©å°è¾“å…¥æ¡†/æ–‡æœ¬åŸŸçš„å­—ä½“å¤§å° */
    padding: 10px;
    /* å‡å°è¾“å…¥æ¡†çš„å†…è¾¹è· */
}

/* 4. ç¼©å°å„ç§é€‰é¡¹å¤é€‰æ¡†çš„æ–‡å­—å¤§å° */
.regex-flags-container,
.scope-options,
.char-binding-item label {
    font-size: 14px;
}

/* 5. è°ƒæ•´ç»‘å®šè§’è‰²åˆ—è¡¨çš„æ ·å¼ */
.char-binding-list {
    padding: 8px;
}

/* 6. è°ƒæ•´ä¿å­˜æŒ‰é’®çš„æ ·å¼ */
#edit-renderer-rule-form .btn-primary {
    margin-top: 10px;
}

/* END: æ¸²æŸ“å™¨é¢æ¿ä¼˜åŒ– */
/* --- æ’¤å›æ¶ˆæ¯åŠŸèƒ½æ–°å¢æ ·å¼ --- */

/* 1. è¿™æ˜¯è¢«æ’¤å›åï¼Œæ¶ˆæ¯å ä½ç¬¦çš„æ ·å¼ */
.recalled-message-placeholder {
    background-color: rgba(200, 200, 200, 0.5);
    color: #666;
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 10px;
    text-align: center;
}

/* 2. è¿™æ˜¯æ¶ˆæ¯æ¶ˆå¤±æ—¶çš„åŠ¨ç”»æ•ˆæœ */
@keyframes recall-animation {
    from {
        opacity: 1;
        transform: scale(1);
    }

    to {
        opacity: 0;
        transform: scale(0.8);
    }
}

.recalled-animation {
    animation: recall-animation 0.3s ease-out forwards;
}

/* --- å¾®ä¿¡è¾“å…¥æ å¸ƒå±€ & åŠŸèƒ½é¢æ¿æ ·å¼ --- */

/* 1. å¸ƒå±€åˆ‡æ¢æ ¸å¿ƒè§„åˆ™ */
/* é»˜è®¤æƒ…å†µä¸‹ï¼Œéšè—å¾®ä¿¡å¸ƒå±€å’ŒåŠŸèƒ½é¢æ¿ */
#wechat-input-area,
.function-panel {
    display: none;
}

/* å½“ .wechat-layout-active åº”ç”¨æ—¶ï¼Œæ˜¾ç¤ºå¾®ä¿¡å¸ƒå±€ï¼Œéšè—æ—§å¸ƒå±€ */
.phone-screen.wechat-layout-active #message-input-default,
.phone-screen.wechat-layout-active #sticker-bar {
    display: none !important;
}

.phone-screen.wechat-layout-active #wechat-input-area {
    display: flex !important;
}

/* ä¸ºæ–°è¾“å…¥æ è°ƒæ•´èŠå¤©å†…å®¹åŒºçš„åº•éƒ¨é—´è· */
.phone-screen.wechat-layout-active #chat-room-screen .content {
    padding-bottom: 0px !important;
}

/* 2. å¾®ä¿¡é£æ ¼è¾“å…¥æ æ ·å¼ */
#wechat-input-area {
    gap: 10px;
    align-items: center;
}

#wechat-message-input {
    flex-grow: 1;
    border: none;
    padding: 12px;
    border-radius: 18px;
    background-color: #f0f0f0;
}

#wechat-message-input:focus {
    outline: none;
}

/* 3. åŠŸèƒ½é¢æ¿æ ·å¼ */
.function-panel {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #f7f7f7;
    border-top: 1px solid #ddd;
    padding: 20px;
    padding-bottom: calc(20px + env(safe-area-inset-bottom));
    box-sizing: border-box;
    z-index: 25;
    transform: translateY(100%);
    transition: transform 0.3s ease-out;
}

.function-panel.visible {
    display: block;
    /* å…ˆè®¾ä¸ºblockæ‰èƒ½æœ‰åŠ¨ç”» */
    transform: translateY(0);
}

/* 4. é¢æ¿å†…éƒ¨åŠŸèƒ½ç½‘æ ¼æ ·å¼ */
.function-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
}

.function-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-size: 12px;
    color: #666;
}

.function-item .icon-bg {
    width: 60px;
    height: 60px;
    background-color: #fff;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.function-item .icon-bg svg {
    width: 28px;
    height: 28px;
    fill: #555;
}

/* === æ—¥è®°åŠŸèƒ½æ‰©å±•æ ·å¼ === */

/* â€œæˆ‘çš„æ—¥è®°â€æ¡ç›®æ ·å¼ */
.user-diary-entry {
    background-color: #f0f4f8;
    /* ä½¿ç”¨æ·¡è“è‰²èƒŒæ™¯ä»¥åŒºåˆ†AIæ—¥è®° */
    border-left-color: #64b5f6;
    /* å·¦ä¾§è¾¹æ¡†ä¹Ÿç”¨è“è‰² */
}

/* AIè¯„è®ºåŒºæ ·å¼ */
.ai-comment-section {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px dashed #d0d8e0;
}

.ai-comment-entry {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.ai-comment-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.ai-comment-bubble {
    background-color: #fff;
    border-radius: 10px;
    padding: 10px 12px;
    font-size: 14px;
    color: #555;
    flex-grow: 1;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.ai-comment-header {
    font-weight: bold;
    color: var(--secondary-color);
    margin-bottom: 5px;
}

/* AIæ—¥è®°ç¿»é¡µæŒ‰é’® */
.diary-pagination {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
}

.diary-pagination button {
    padding: 6px 14px;
    font-size: 14px;
}

.diary-pagination .page-indicator {
    font-size: 14px;
    color: #888;
}

/* ä¿®å¤ä¹‹å‰æ‰€æœ‰é¡µé¢çš„ç™½å±é—®é¢˜ */
#diary-screen .content,
#user-diary-screen .content,
#favorites-diary-screen .content,
#api-settings-screen .content,
#world-book-screen .content,
#renderer-screen .content,
#wallet-screen .content,
#wallet-settings-screen .content,
#customize-screen .content,
#tutorial-screen .content {
    flex-grow: 1;
    overflow-y: auto;
    height: auto;
    min-height: 0;
    padding-bottom: 80px;
    /* ä¸ºåº•éƒ¨å¯¼èˆªæ é¢„ç•™ç©ºé—´ */
}

/* === æ—¥è®°åŠŸèƒ½æ‰©å±•ä¸ä¿®å¤æ ·å¼ === */

/* 1. ä½¿æ—¥è®°æ¡ç›®æœ¬èº«æˆä¸ºä¸€ä¸ªå¯äº¤äº’çš„å— */
.diary-entry {
    display: block;
}

/* 2. å°†æ—¥è®°å¤´éƒ¨ç”¨ä½œæŠ˜å /å±•å¼€çš„è§¦å‘å™¨ */
.diary-header {
    cursor: pointer;
}

/* 3. æ—¥è®°å†…å®¹å’ŒAIè¯„è®ºåŒºé»˜è®¤éšè—ï¼Œé€šè¿‡ <details> æ ‡ç­¾æ§åˆ¶ */
.diary-entry>.diary-content,
.diary-entry>.ai-comment-section {
    display: none;
    padding-top: 10px;
}

.diary-entry[open]>.diary-content,
.diary-entry[open]>.ai-comment-section {
    display: block;
    /* å½“ <details> å…ƒç´ è¢«æ‰“å¼€æ—¶æ˜¾ç¤º */
}

/* 4. AIè¯„è®ºåŒºæ ·å¼ */
.ai-comment-section {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #e0c8d1;
}

.ai-comment-header {
    /* â€œAIçš„æ‚„æ‚„è¯â€ æ ‡é¢˜ */
    font-weight: bold;
    color: var(--secondary-color);
    margin-bottom: 10px;
    cursor: pointer;
    /* è®©å®ƒçœ‹èµ·æ¥å¯ä»¥ç‚¹å‡» */
}

.ai-comment-entry {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.ai-comment-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.ai-comment-bubble {
    background-color: #fff;
    border-radius: 10px;
    padding: 10px 12px;
    font-size: 14px;
    color: #555;
    flex-grow: 1;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    white-space: pre-wrap;
    /* ä¿ç•™è¯„è®ºä¸­çš„æ¢è¡Œ */
}

/* 5. AIæ—¥è®°ç¿»é¡µæŒ‰é’® */
.diary-pagination {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
}

.diary-pagination button {
    padding: 6px 14px;
    font-size: 14px;
}

.diary-pagination .page-indicator {
    font-size: 14px;
    color: #888;
}

/* 6. ç»Ÿä¸€çš„ç™½å±ä¿®å¤ (è¦†ç›–ä¹‹å‰çš„æ‰€æœ‰ä¿®å¤) */
.screen .content {
    flex-grow: 1;
    overflow-y: auto;
    height: auto;
    min-height: 0;
    padding-bottom: 80px;
    /* ä¸ºåº•éƒ¨å¯¼èˆªæ é¢„ç•™ç©ºé—´ */
}

/* --- AIè½¨è¿¹/å¿ƒå£°æŒ‰é’®æ¿€æ´»æ ·å¼ --- */
#ai-trajectory-btn.active-heart-sound svg {
    color: #007BFF !important;
    /* åˆ‡æ¢ä¸ºè“è‰² */
    transform: scale(1.1);
    /* è½»å¾®æ”¾å¤§ä»¥ç¤ºåŒºåˆ« */
    transition: color 0.3s ease, transform 0.3s ease;
}

/* éšè—ä¸»é¡µçš„ç¿»é¡µæŒ‡ç¤ºåœ†ç‚¹ */
.home-page-indicator {
    display: none !important;
}

/* å•†åŸåŠŸèƒ½æ•´ä½“æ ·å¼ */
#mall-screen .content {
    padding: 60px 10px 80px 10px;
    /* é¡¶éƒ¨ä¸ºæœç´¢æ ç•™ç©ºï¼Œåº•éƒ¨ä¸ºå¯¼èˆªæ ç•™ç©º */
    background-color: #f5f5f5;
}

.mall-header {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 10px;
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #eee;
    z-index: 10;
}

.search-bar-container {
    flex-grow: 1;
    display: flex;
    align-items: center;
    background-color: #f5f5f5;
    border-radius: 18px;
    padding: 0 12px;
}

.search-bar-container .search-icon {
    width: 20px;
    height: 20px;
    fill: #999;
    margin-right: 8px;
}

.search-bar-container input {
    width: 100%;
    border: none;
    background: transparent;
    height: 36px;
    font-size: 14px;
}

.search-bar-container input:focus {
    outline: none;
}

.mall-categories {
    display: flex;
    justify-content: space-around;
    padding: 15px 5px;
    background-color: #fff;
    border-radius: 12px;
    margin-bottom: 10px;
}

.product-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

.product-card {
    background-color: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
}

.product-card .product-image {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: cover;
}

.product-card .product-info {
    padding: 10px;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
}

.product-card .product-title {
    font-size: 14px;
    color: #333;
    line-height: 1.4;
    margin: 0 0 5px 0;
    /* å¤šè¡Œæ–‡å­—çœç•¥å· */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    text-overflow: ellipsis;
    height: 39.2px;
    /* 14px * 1.4 * 2 lines */
}

.product-card .product-tags {
    margin-bottom: 8px;
}

.product-card .product-tags .tag {
    background-color: #fff0f5;
    color: var(--primary-color);
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 4px;
    margin-right: 5px;
}

.product-card .product-price-row {
    margin-top: auto;
    /* å°†ä»·æ ¼æ¨åˆ°åº•éƒ¨ */
    display: flex;
    align-items: baseline;
    justify-content: space-between;
}

.product-card .product-price {
    font-size: 18px;
    font-weight: bold;
    color: #e53935;
}

.product-card .product-price::before {
    content: 'Â¥';
    font-size: 12px;
    margin-right: 2px;
}

.product-card .product-sales {
    font-size: 12px;
    color: #999;
}

/* å•†åŸåº•éƒ¨å¯¼èˆªæ ·å¼ */
.mall-bottom-nav {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-top: 1px solid #eee;
    display: flex;
    justify-content: space-around;
    align-items: center;
    z-index: 200;
}

.mall-bottom-nav .nav-item {
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    color: #888;
}

.mall-bottom-nav .nav-item svg {
    width: 24px;
    height: 24px;
    fill: currentColor;
}

.mall-bottom-nav .nav-item span {
    font-size: 10px;
}

.mall-bottom-nav .nav-item.active {
    color: var(--primary-color);
}

/* å•†å“è¯¦æƒ…é¡µé¢æ ·å¼ */
#product-detail-screen .content {
    background-color: #f5f5f5;
}

.product-detail-card {
    background-color: #fff;
    border-radius: 12px;
    margin-bottom: 10px;
}

.detail-product-image {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: cover;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.detail-product-info {
    padding: 15px;
}

.detail-price-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.detail-product-price {
    font-size: 24px;
    font-weight: bold;
    color: #e53935;
}

.detail-stats {
    font-size: 14px;
    color: #888;
    display: flex;
    gap: 15px;
}

.detail-product-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin: 0 0 10px 0;
}

.detail-product-description {
    font-size: 14px;
    color: #666;
    line-height: 1.6;
    margin: 0;
}

.detail-store-info {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 15px;
    border-top: 1px solid #f5f5f5;
    border-bottom: 10px solid #f5f5f5;
}

.detail-store-info .store-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
}

.comment-section {
    padding: 15px;
}

.comment-section h3 {
    margin: 0 0 15px 0;
    font-size: 16px;
}

#comment-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.comment-item {
    padding: 15px 0;
    border-bottom: 1px solid #f5f5f5;
}

.comment-item:last-child {
    border-bottom: none;
}

.comment-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
}

.comment-avatar {
    width: 30px;
    height: 30px;
    border-radius: 50%;
}

.comment-author {
    font-weight: 500;
    font-size: 14px;
}

.comment-text {
    font-size: 14px;
    line-height: 1.7;
    margin-bottom: 10px;
}

.seller-reply {
    background-color: #fff8e1;
    border-radius: 8px;
    padding: 10px;
    font-size: 13px;
    margin-top: 10px;
}

.seller-reply::before {
    content: 'å•†å®¶å›å¤ï¼š';
    font-weight: bold;
    color: #f57f17;
}

.detail-footer-nav {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background: #fff;
    border-top: 1px solid #eee;
    display: flex;
    padding: 8px;
    gap: 8px;
    z-index: 10;
}

.detail-footer-nav .action-btn {
    flex: 1;
    border: none;
    border-radius: 20px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    background-color: #ffcdd2;
    color: var(--primary-color);
}

.detail-footer-nav .action-btn.primary {
    background-color: var(--primary-color);
    color: white;
}

/* --- å•†åŸè´­ç‰©æµç¨‹ & è´­ç‰©è½¦æ ·å¼ --- */
.purchase-flow-modal {
    padding: 15px;
}

.close-purchase-modal-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 24px;
    color: #999;
    cursor: pointer;
}

.purchase-product-info {
    display: flex;
    align-items: flex-end;
    gap: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f0f0f0;
}

.purchase-product-info img {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    object-fit: cover;
}

.purchase-product-info p {
    color: #e53935;
    font-size: 20px;
    font-weight: bold;
    margin: 0 0 5px 0;
}

.purchase-product-info h4 {
    font-size: 16px;
    margin: 0;
}

.purchase-section {
    padding: 15px 0;
}

.purchase-section h5 {
    margin: 0 0 10px 0;
    font-size: 14px;
    color: #555;
}

#recipient-selection-list {
    max-height: 25vh;
    overflow-y: auto;
}

#recipient-selection-list .list-item {
    padding: 10px 5px;
}

.style-options {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.style-option-btn {
    padding: 8px 15px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    color: #333;
    border-radius: 15px;
    cursor: pointer;
}

.style-option-btn.active {
    border-color: var(--primary-color);
    background-color: #fff0f5;
    color: var(--primary-color);
}

.quantity-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.quantity-selector {
    display: flex;
    align-items: center;
}

.quantity-selector .quantity-btn {
    width: 28px;
    height: 28px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    font-size: 18px;
    cursor: pointer;
}

.quantity-selector input {
    width: 50px;
    height: 28px;
    text-align: center;
    border: 1px solid #ddd;
    border-left: none;
    border-right: none;
}

/* è´­ç‰©è½¦å•†å“é¡¹æ ·å¼ */
.cart-item {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
    display: flex;
    gap: 15px;
}

.cart-item-image {
    width: 90px;
    height: 90px;
    border-radius: 8px;
    object-fit: cover;
    flex-shrink: 0;
}

.cart-item-details {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

.cart-item-title {
    font-size: 14px;
    margin: 0 0 8px 0;
}

.cart-item-price {
    font-size: 16px;
    font-weight: bold;
    color: #e53935;
    margin-top: auto;
}

.cart-item-actions {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    justify-content: space-between;
}

.cart-item-actions .to-pay-btn {
    padding: 6px 12px;
    font-size: 13px;
    background-color: #e53935;
    color: white;
}

.cart-payment-countdown {
    font-size: 12px;
    color: #e53935;
}

/* å‘é€åˆ°èŠå¤©ä¸­çš„å•†å“åç‰‡æ ·å¼ */
.product-delivery-card {
    width: 240px;
    background-color: #fff;
    border-radius: var(--border-radius);
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 0 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    border: 1px solid #eee;
}

.message-wrapper.sent .product-delivery-card {
    border-bottom-right-radius: 5px;
}

.product-delivery-card-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    border-radius: 8px;
    object-fit: cover;
}

.product-delivery-card-info {
    overflow: hidden;
    flex-grow: 1;
}

.product-delivery-card-title {
    font-size: 15px;
    font-weight: 500;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin: 0 0 4px 0;
}

.delivery-countdown-display {
    font-size: 12px;
    color: #e53935;
    font-weight: bold;
    margin: 0;
}

/* --- å•†åŸåˆ·æ–°ä¸åŠ è½½æ›´å¤šæ ·å¼ --- */
#refresh-mall-btn svg.rotating {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

.load-more-indicator {
    display: none;
    /* é»˜è®¤éšè— */
    text-align: center;
    padding: 15px;
    color: #888;
    font-size: 14px;
}

.load-more-indicator.loading {
    display: block;
    /* åŠ è½½æ—¶æ˜¾ç¤º */
}

/* --- ä¸ªäººä¸»é¡µæ‰©å±•æ ·å¼ --- */
.profile-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    background-color: #fff;
    margin: -20px -10px 10px -10px;
    /* é¡¶éƒ¨å’Œå·¦å³è´´è¾¹ï¼Œåº•éƒ¨ç•™å‡ºé—´è· */
}

.profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #fff;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 15px;
}

.profile-username {
    font-size: 20px;
    font-weight: 600;
    color: #333;
    margin: 0;
}

.profile-section {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
}

.profile-section .section-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    margin: 0 0 15px 0;
    padding-bottom: 10px;
    border-bottom: 1px solid #f5f5f5;
}

/* --- æ–°å¢ï¼šæ”¯ä»˜ç¡®è®¤é¡µé¢æ ·å¼ --- */
.recipient-selector-section,
.delivery-time-section {
    padding-bottom: 10px;
}

.recipient-selector-section h5,
.delivery-time-section h5 {
    margin: 0 0 10px;
    font-size: 14px;
    color: #555;
}

.payment-methods .method-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 0;
    cursor: pointer;
    font-weight: 500;
}

.payment-methods .method-item.selected::after {
    content: 'âœ“';
    color: var(--primary-color);
    font-size: 20px;
    font-weight: bold;
    margin-left: auto;
}

.payment-methods .method-item img {
    width: 24px;
    height: 24px;
}

.payment-footer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background: #fff;
    border-top: 1px solid #eee;
    z-index: 10;
}

.payment-footer .total-price {
    color: #e53935;
    font-size: 18px;
    font-weight: bold;
}

#confirm-final-payment-btn {
    padding: 10px 30px;
    border-radius: 20px;
}

/* --- æ–°å¢ï¼šä»£ä»˜è¯·æ±‚å¡ç‰‡æ ·å¼ --- */
.payment-request-card {
    width: 240px;
    border-radius: var(--border-radius);
    margin: 0 8px;
    background: linear-gradient(135deg, #FFC107, #FF9800);
    color: white;
    padding: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.payment-request-title {
    font-size: 14px;
    opacity: 0.9;
}

.payment-request-amount {
    font-size: 32px;
    font-weight: bold;
    margin: 5px 0;
}

.payment-request-desc {
    font-size: 13px;
    margin-bottom: 15px;
    max-height: 40px;
    overflow: hidden;
}

.payment-request-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.payment-request-actions button {
    flex: 1;
    border-radius: 8px;
    padding: 8px;
}

.payment-request-status {
    font-weight: bold;
    text-align: center;
    margin-top: 10px;
}

/* --- æ–°å¢ï¼šç‰©æµç•Œé¢æ ·å¼ --- */
.logistics-item {
    background-color: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
}

.logistics-header {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    margin-bottom: 10px;
}

.logistics-status {
    color: var(--primary-color);
    font-weight: bold;
}

.logistics-body {
    display: flex;
    gap: 10px;
    align-items: center;
}

.logistics-body img {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    object-fit: cover;
}

.logistics-info .item-name {
    font-weight: 500;
}

.logistics-info .eta {
    font-size: 12px;
    color: #888;
    margin-top: 5px;
}

.logistics-info .recipient-info {
    font-size: 12px;
    color: #888;
    margin-top: 5px;
}

/* =========================================== */
/* START: å¿ƒçµç¾ç»Š App V3.0 æ ·å¼ (ç²‰è‰²ä¸»é¢˜) */
/* =========================================== */

#soul-bond-screen .app-header {
    background-color: #fff8fa;
    /* æ¢å¤ä¸ºæ·¡ç²‰è‰²æ ‡é¢˜æ  */
    border-bottom: none;
}

#soul-bond-screen .content {
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease-in-out;
    background-color: #fff8fa;
    /* ç»Ÿä¸€ä¸ºæ·¡ç²‰è‰²èƒŒæ™¯ */
    padding: 15px;
    display: flex;
    flex-direction: column;
}

/* é¡¶éƒ¨ç…§ç‰‡æ»šåŠ¨åŒºåŸŸ (ä¿æŒä¸å˜) */
.bond-photo-scroll-container {
    flex-shrink: 0;
    overflow-x: auto;
    padding-bottom: 20px;
    /* éšè—æ»šåŠ¨æ¡ */
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.bond-photo-scroll-container::-webkit-scrollbar {
    display: none;
}

.bond-photo-scroll {
    display: flex;
    gap: 15px;
    padding: 10px;
}

/* æ‹ç«‹å¾—å¡ç‰‡ç¿»è½¬æ•ˆæœ (ä¿æŒä¸å˜) */
.bond-photo-item {
    flex-shrink: 0;
    width: 110px;
    height: 130px;
    perspective: 1000px;
    cursor: pointer;
}

.bond-photo-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
}

.bond-photo-item.is-flipped .bond-photo-inner {
    transform: rotateY(180deg);
}

.bond-photo-front,
.bond-photo-back {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    background-color: white;
    padding: 8px;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.bond-photo-front img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.bond-photo-back {
    transform: rotateY(180deg);
    font-size: 13px;
    color: #666;
    font-family: 'Comic Sans MS', 'Chalkduster', cursive;
    text-align: center;
    padding: 15px;
}

.bond-photo-front::before {
    content: '';
    position: absolute;
    top: -5px;
    left: 50%;
    transform: translateX(-50%);
    width: 40px;
    height: 15px;
    background-color: rgba(255, 222, 233, 0.8);
    /* æ·¡ç²‰è‰²èƒ¶å¸¦ */
    border-radius: 2px;
}

/* --- æ ¸å¿ƒä¿®æ”¹ï¼šæ¢å¤æ—§ç‰ˆå¤§å¡ç‰‡æ ·å¼ --- */
.bond-main-card {
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 24px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    animation: fadeIn 0.8s ease;
    margin: 15px 0;
    /* ä¸Šä¸‹è¾¹è· */
}

.bond-anniversary p {
    margin: 0;
    font-size: 14px;
    color: var(--secondary-color);
}

.bond-anniversary h2 {
    font-size: 56px;
    margin: 5px 0;
    color: var(--primary-color);
    font-weight: 700;
}

.bond-anniversary span {
    font-size: 14px;
    color: var(--secondary-color);
}

.bond-avatars {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin: 25px 0;
}

.bond-avatar-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}

.bond-avatar-container img {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid white;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.bond-avatar-container span {
    font-weight: 600;
    color: var(--text-color);
}

.bond-heart {
    width: 30px;
    height: 30px;
    fill: var(--primary-color);
    animation: heart-pulse 1.5s infinite ease-in-out;
}

@keyframes heart-pulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }
}

.bond-days-counter {
    font-size: 16px;
    color: #555;
}

.bond-days-counter strong {
    color: var(--primary-color);
    font-weight: 700;
}

/* --- æ—§ç‰ˆæ ·å¼æ¢å¤ç»“æŸ --- */

.bond-section-title {
    text-align: center;
    color: var(--secondary-color);
    margin: 20px 0 15px;
    font-weight: 600;
}

/* åº•éƒ¨åŠŸèƒ½å¯¼èˆªæ  (é¢œè‰²ä¿®æ”¹) */
.bond-bottom-nav {
    position: absolute;
    bottom: 15px;
    left: 15px;
    right: 15px;
    background-color: var(--primary-color);
    /* ä¸»é¢˜ç²‰è‰² */
    border-radius: 24px;
    box-shadow: 0 6px 20px rgba(255, 128, 171, 0.3);
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 10px 0;
    z-index: 100;
}

.bond-nav-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
}

.bond-nav-btn svg {
    width: 28px;
    height: 28px;
    fill: white;
    /* å›¾æ ‡æ”¹ä¸ºç™½è‰² */
}

/* ç§»é™¤ä¸å†ä½¿ç”¨çš„å…ƒç´ çš„æ ·å¼ */
.bond-profile-section,
.bond-tabs,
.bond-post-moment-btn {
    display: none !important;
}

/* =========================================== */
/* END: å¿ƒçµç¾ç»Š App æ ·å¼ */
/* =========================================== */

/* --- å¿ƒçµç¾ç»Š - æ„¿æœ›æ¸…å•æ ·å¼ --- */
#bond-wishlist-container .list-item {
    display: block;
    /* è¦†ç›–é»˜è®¤çš„flexå¸ƒå±€ */
    padding: 15px;
}

.wish-item {
    display: flex;
    align-items: center;
    gap: 15px;
}

.wish-checkbox {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
    accent-color: var(--primary-color);
}

.wish-item .item-details {
    transition: opacity 0.3s ease;
}

.wish-item.completed .item-name {
    text-decoration: line-through;
    color: #aaa;
}

.wish-item.completed .item-details {
    opacity: 0.6;
}


/* å°½é‡éš”ç¦»å‘½åé¿å…å†²çª */
.icity-moments-wrap {
    width: 100%;
    margin-bottom: 14px;
    display: flex;
    justify-content: center;
}

.icity-moments-inner {
    width: calc(100% - 20px);
    max-width: 760px;
    /* è‡ªé€‚åº”æ‰‹æœºä¸æ¡Œé¢ */
    position: relative;
}

/* é»‘è‰²èƒŒæ™¯ / é¡¶å›¾ */
.icity-hero {
    height: 150px;
    background: #000;
    /* é»˜è®¤çº¯é»‘ */
    border-radius: 14px 14px 0 0;
    overflow: hidden;
    position: relative;
    background-size: cover;
    /* æ¢å¤ï¼šè®©å›¾ç‰‡å¡«æ»¡å®¹å™¨ */
    background-position: center;
    /* ä¿æŒï¼šè®©å›¾ç‰‡å±…ä¸­æ˜¾ç¤º */
}

/* ç™½è‰²å¤´åƒåœ†ï¼ˆä½äº hero åº•éƒ¨å±…ä¸­ï¼Œéƒ¨åˆ†è¦†ç›–ä¸‹æ–¹ç™½å¡ï¼‰ */
.icity-avatar-wrap {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: -46px;
    /* å¤´åƒä¼šè¦†ç›–åˆ°ä¸‹æ–¹ä¿¡æ¯å¡ */
    width: 110px;
    height: 110px;
    border-radius: 50%;
    background: #fff;
    /* é»˜è®¤å¤´åƒçº¯ç™½ */
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 6px solid rgba(255, 255, 255, 0.9);
}

.icity-avatar-wrap img {
    width: 80%;
    height: 80%;
    border-radius: 50%;
    object-fit: cover;
    display: block;
}

/* ç™½è‰²ä¿¡æ¯å¡ */
.icity-info-card {
    background: #fff;
    border-radius: 14px;
    padding: 64px 18px 18px;
    /* top padding ç•™å‡ºå¤´åƒåŒºåŸŸ */
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.04);
    margin-top: 10px;
    box-sizing: border-box;
    text-align: center;
}

.icity-name {
    font-size: 22px;
    font-weight: 700;
    color: #111;
    margin: 0;
    line-height: 1;
}

.icity-id-loc {
    margin-top: 8px;
    display: flex;
    justify-content: center;
    gap: 10px;
    align-items: center;
    font-size: 13px;
    color: #888;
}

.icity-signature {
    margin-top: 12px;
    color: #666;
    font-size: 14px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* å°å›¾æ ‡ï¼ˆå®šä½æ ‡è¯†ï¼‰ */
.icity-id-loc .dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #ddd;
    display: inline-block;
    margin-right: 6px;
}

/* å“åº”ï¼šå°å±æ—¶é€‚é… */
@media (max-width:420px) {
    .icity-avatar-wrap {
        width: 90px;
        height: 90px;
        bottom: -40px;
    }

    .icity-info-card {
        padding-top: 56px;
    }

    .icity-name {
        font-size: 20px;
    }
}

/* --- åŠ¨æ€å¤šé€‰æ¨¡å¼æ ·å¼ (æœ€ç»ˆç‰ˆ) --- */
#moments-screen.is-delete-mode .moment-item {
    cursor: pointer;
    user-select: none;
}

.moment-item.is-selected {
    outline: 2px solid var(--accent-color, #4c9ffe);
    position: relative;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(76, 159, 254, 0.2) !important;
}

.moment-item.is-selected::after {
    content: 'âœ“';
    position: absolute;
    right: 8px;
    top: 8px;
    width: 22px;
    height: 22px;
    line-height: 22px;
    text-align: center;
    border-radius: 50%;
    background: rgba(0, 0, 0, .6);
    color: #fff;
    font-weight: 700;
    font-size: 14px;
    z-index: 10;
}

/* åº•éƒ¨å¤šé€‰æ“ä½œæ  */
.multi-select-bar {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 14px;
    background: #111;
    color: #fff;
    transform: translateY(100%);
    transition: transform .25s ease;
    z-index: 250;
}

.multi-select-bar.show {
    transform: translateY(0%);
}

.multi-select-bar .danger {
    color: #fff;
    background: #e5484d;
    border-radius: 10px;
    padding: 8px 12px;
}

.action-btn-group {
    display: inline-flex;
    gap: 8px;
    align-items: center;
}


.memory-title {
    font-size: 20px;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #f0f0f0;
}

.memory-main-content {
    font-size: 15px;
    color: var(--text-color);
    margin-bottom: 25px;
    white-space: pre-wrap;
    /* ä¿ç•™AIç”Ÿæˆå†…å®¹é‡Œçš„æ¢è¡Œ */
}

.memory-commentary {
    background-color: #fff8fa;
    border-left: 4px solid var(--secondary-color);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 0 8px 8px 0;
    font-style: italic;
    color: #666;
}

.memory-signature {
    text-align: right;
    color: #888;
    font-size: 14px;
}

.memory-signature .ai-name {
    display: block;
    margin-bottom: 5px;
}

/* --- æœ€ç»ˆä¿®å¤ï¼šâ€œæˆ‘çš„é’±åŒ…â€ç­‰é¡µé¢å†…å®¹æº¢å‡ºï¼Œè®©å…¶è¢«åŒ…è£¹åœ¨æ‰‹æœºå†…éƒ¨ --- */
#wallet-screen .content,
#forum-screen .content,
#forum-thread-screen .content,
#chat-list-screen .content,
#world-book-screen .content,
#api-settings-screen .content,
#diary-screen .content,
#ai-character-select-screen .content,
#ai-chat-list-screen .content,
#ai-chat-view-screen .content {
    flex-grow: 1;
    /* å…³é”®ï¼šè®©å†…å®¹åŒºå æ®æ‰€æœ‰å‰©ä½™ç©ºé—´ */
    overflow-y: auto;
    /* å…³é”®ï¼šå½“å†…å®¹è¶…å‡ºæ—¶ï¼Œåªæ»šåŠ¨å†…å®¹åŒºæœ¬èº« */
    height: auto;
    /* ç§»é™¤å›ºå®šçš„100%é«˜åº¦ */
    min-height: 0;
    /* flexå¸ƒå±€çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œé˜²æ­¢å†…å®¹æ’‘ç ´å®¹å™¨ */
}

/* ä¸ºé’±åŒ…å’Œè®ºå›ç­‰é¡µé¢çš„å†…å®¹åŒºå¢åŠ åº•éƒ¨å†…è¾¹è·ï¼Œé˜²æ­¢è¢«åº•éƒ¨å¯¼èˆªæ é®æŒ¡ */
#wallet-screen .content,
#forum-screen .content,
#forum-thread-screen .content {
    padding-bottom: 80px;
}

/* --- é•¿æˆªå›¾é€‰æ‹©æ¨¡å¼æ ·å¼ --- */
#chat-room-screen.screenshot-mode .message-wrapper {
    cursor: pointer;
    transition: background-color 0.2s;
}

/* æ¶ˆæ¯è¢«é€‰ä¸­è¿›è¡Œæˆªå›¾æ—¶çš„æ ·å¼ */
.message-wrapper.screenshot-selected {
    background-color: rgba(144, 202, 249, 0.3) !important;
    border-radius: 10px;
}

/* éšè—èŠå¤©è¾“å…¥æ¡† */
#chat-room-screen.screenshot-mode .chat-input-wrapper {
    display: none !important;
}

/* è°ƒæ•´å†…å®¹åŒºåŸŸçš„åº•éƒ¨å†…è¾¹è·ï¼Œä¸ºæ“ä½œæ ç•™å‡ºç©ºé—´ */
#chat-room-screen.screenshot-mode .content {
    padding-bottom: 60px !important;
}

/* --- æ”¯ä»˜å¼¹çª—å±‚çº§ä¿®å¤ (æœ€ç»ˆç‰ˆ) --- */
#payment-password-modal {
    z-index: 301 !important;
    /* å¼ºåˆ¶è®¾ç½®ä¸€ä¸ªæ¯”å…¶ä»–æ‰€æœ‰å¼¹çª—éƒ½é«˜çš„å±‚çº§ */
}

/* --- å•†åŸåˆ·æ–°ä¸åŠ è½½æ›´å¤šæ ·å¼ --- */
#refresh-mall-btn svg.rotating {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

.load-more-indicator {
    display: none;
    /* é»˜è®¤éšè— */
    text-align: center;
    padding: 15px;
    color: #888;
    font-size: 14px;
}

.load-more-indicator.loading {
    display: block;
    /* åŠ è½½æ—¶æ˜¾ç¤º */
}

/* --- å¿ƒçµç¾ç»Š - äº¤æ¢æ—¥è®°ç¾åŒ–æ ·å¼ --- */
@keyframes breathing {

    0%,
    100% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }
}

.diary-exchange-pair {
    border: 1px solid #f0f0f0;
}

.diary-exchange-entry.user-entry {
    background-color: #fff;
    /* ç”¨æˆ·çš„æ—¥è®°ä½¿ç”¨ç™½è‰²èƒŒæ™¯ */
}

.diary-exchange-entry.ai-reply {
    background-color: #fff8fa;
    /* AIçš„å›å¤ä½¿ç”¨æ·¡ç²‰è‰²èƒŒæ™¯ */
    border-top: 1px solid #fce4ec;
}

.diary-exchange-entry .entry-header {
    position: relative;
    padding-left: 36px;
    /* ä¸ºå¤´åƒç•™å‡ºç©ºé—´ */
}

.diary-exchange-entry .entry-header img {
    position: absolute;
    left: 0;
    top: 0;
}

.diary-exchange-entry .entry-content,
.diary-exchange-entry .entry-image {
    padding-left: 36px;
    /* å†…å®¹ä¹Ÿè¿›è¡Œç¼©è¿› */
    margin-left: 0;
    width: 100%;
}

/* AIå›å¤çš„åŠ è½½ä¸­å’Œé”™è¯¯çŠ¶æ€æ ·å¼ */
.ai-reply .entry-content.pending {
    color: #aaa;
    font-style: italic;
    animation: breathing 2s infinite ease-in-out;
}

.ai-reply .entry-content.error {
    color: #ef5350;
    font-style: italic;
    font-weight: bold;
}

/* =============================================================== */
/* START: å¿ƒçµç¾ç»Š - ç•ªèŒ„é’Ÿ V2.1 æ ·å¼ (æ›¿æ¢æ—§ç‰ˆ) */
/* =============================================================== */

/* --- é¡µé¢ä¸»å¸ƒå±€ --- */
#pomodoro-screen .pomodoro-main-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    /* æ”¹ä¸º space-between ä»¥æ‹‰å¼€å…ƒç´  */
    height: 100%;
    padding: 30px 20px 40px;
    /* ä¸Šã€å·¦å³ã€ä¸‹ */
    background-color: #fdf6f8;
    background-size: cover;
    background-position: center;
    box-sizing: border-box;
}

/* --- é¡¶éƒ¨ Header æŒ‰é’®ä¿®å¤ --- */
#pomodoro-screen .app-header .action-btn svg {
    fill: var(--primary-color);
    /* ç¡®ä¿æŒ‰é’®å›¾æ ‡å¯è§ */
}

/* --- è®¡æ—¶å™¨å¡ç‰‡ (ç¼©å°) --- */
.pomodoro-timer-card {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 18px;
    padding: 12px 20px;
    /* ç¼©å°å‚ç›´å†…è¾¹è· */
    width: 100%;
    max-width: 300px;
    /* ç¼©å°æœ€å¤§å®½åº¦ */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    background-size: cover;
    background-position: center;
}

/* --- è®¡æ—¶å™¨æ•°å­— (ç¼©å°) --- */
.pomodoro-time-display {
    font-size: 56px;
    /* ç¼©å°å­—ä½“ */
    font-weight: 600;
    color: var(--primary-color);
    letter-spacing: 2px;
    text-align: center;
    /* ç¡®ä¿æ•°å­—å±…ä¸­ */
    margin: 5px 0;
}

/* --- ä»»åŠ¡æ  --- */
.pomodoro-task-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8px;
    font-size: 13px;
    /* ç¼©å°å­—ä½“ */
    color: #666;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    padding-top: 8px;
}

#pomodoro-task-name {
    font-weight: bold;
    color: var(--secondary-color);
    padding: 2px 5px;
    border-radius: 5px;
    outline: none;
    text-align: right;
}

#pomodoro-task-name:focus {
    background-color: #fce4ec;
}

/* --- AI å¤´åƒ --- */
.pomodoro-avatar-wrapper {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 5px solid white;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: transform 0.2s ease;
    margin: 20px 0;
    /* è‡ªåŠ¨å¤–è¾¹è· */
}

.pomodoro-avatar-wrapper:active {
    transform: scale(0.95);
}

#pomodoro-ai-avatar {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

/* --- AI é™ªä¼´æ¶ˆæ¯ --- */
.pomodoro-ai-message {
    text-align: center;
    background: rgba(255, 255, 255, 0.7);
    padding: 15px 20px;
    border-radius: 18px;
    max-width: 320px;
    width: 100%;
}

#pomodoro-ai-status {
    font-size: 12px;
    color: #888;
    margin-bottom: 8px;
}

#pomodoro-ai-companion-text {
    font-size: 15px;
    color: var(--text-color);
    line-height: 1.6;
}

/* --- å¼€å§‹/æš‚åœæŒ‰é’® --- */
.pomodoro-start-button {
    width: 200px;
    padding: 15px;
    border-radius: 25px;
    border: none;
    background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
    color: white;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(255, 128, 171, 0.4);
    transition: all 0.2s ease;
    margin-top: 20px;
    /* è‡ªåŠ¨å¤–è¾¹è· */
}

.pomodoro-start-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 128, 171, 0.5);
}

.pomodoro-start-button:disabled {
    background: #ccc;
    box-shadow: none;
    cursor: not-allowed;
}

/* --- å†å²è®°å½•é¡µé¢æ ·å¼ --- */
#pomodoro-history-list .list-item {
    display: flex;
    justify-content: space-between;
}

#pomodoro-history-list .item-preview {
    color: var(--primary-color);
    font-weight: 500;
}

/* =============================================================== */
/* END: å¿ƒçµç¾ç»Š - ç•ªèŒ„é’Ÿ V2.1 æ ·å¼ */
/* =============================================================== */
/* --- åœ¨ <style> æ ‡ç­¾æœ«å°¾æ·»åŠ  --- */

/* èŠå¤©åˆ—è¡¨ä¸­å¿ƒåŠ¨å…³ç³»å›¾æ ‡çš„æ ·å¼ */
.soul-bond-icon .soul-bond-icon-svg {
    width: 20px;
    height: 20px;
    fill: var(--primary-color);
    /* ä½¿ç”¨ä¸»é¢˜ç²‰è‰² */
    transition: transform 0.2s ease, filter 0.2s ease;
}

.soul-bond-icon:hover .soul-bond-icon-svg {
    transform: scale(1.2);
    filter: brightness(1.1);
}

/* --- åœ¨ <style> æ ‡ç­¾æœ«å°¾æ·»åŠ  --- */

/* AIå‘é€çš„ç»‘å®šé‚€è¯·å¡ç‰‡æ ·å¼ */
.bond-request-card {
    width: 240px;
    border-radius: var(--border-radius);
    margin: 0 8px;
    background: linear-gradient(135deg, #FFD54F, #FFC107);
    color: #8C6500;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.bond-request-card p {
    margin: 0 0 15px 0;
    font-weight: 500;
}

.bond-request-actions {
    display: flex;
    gap: 10px;
}

.bond-request-actions button {
    flex: 1;
    border-radius: 12px;
    padding: 10px;
    font-weight: bold;
}

.bond-request-status {
    font-weight: bold;
    margin-top: 15px;
    font-size: 14px;
}

#chat-search-input {
    width: 100%;
    padding: 10px 15px;
    border-radius: 18px;
    border: none;
    background-color: #f0f0f0;
    font-size: 14px;
}

#chat-search-input:focus {
    outline: none;
}

.search-result-item .item-preview.search-preview {
    white-space: normal;
    -webkit-line-clamp: 2;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.search-result-item .highlight {
    background-color: #FFF59D;
    /* äº®é»„è‰²é«˜äº® */
    color: #424242;
    font-weight: bold;
    border-radius: 3px;
}

@keyframes highlight-fade {
    from {
        background-color: rgba(255, 236, 179, 0.7);
    }

    /* æ©™é»„è‰²é«˜äº®ï¼Œç”¨äºè·³è½¬å */
    to {
        background-color: transparent;
    }
}

.message-highlight {
    animation: highlight-fade 2s ease-out forwards;
    border-radius: 10px;
}

/* --- ä¿®æ”¹ï¼šå­—ä½“é¢„è®¾æŒ‰é’®å¤§å°ç»Ÿä¸€ä¿®å¤ --- */
#font-presets-control .btn-small {
    flex: 1;
    /* è®©ä¸‰ä¸ªæŒ‰é’®å¹³åˆ†ç©ºé—´ï¼Œå®½åº¦å¼ºåˆ¶ä¿æŒä¸€è‡´ */
    height: 38px;
    /* æ–°å¢ï¼šå¼ºåˆ¶è®¾å®šä¸€ä¸ªç»Ÿä¸€çš„é«˜åº¦ */
    padding-top: 0;
    /* æ–°å¢ï¼šé…åˆå›ºå®šé«˜åº¦ï¼Œé‡ç½®ä¸Šä¸‹å†…è¾¹è· */
    padding-bottom: 0;
    /* æ–°å¢ï¼šé…åˆå›ºå®šé«˜åº¦ï¼Œé‡ç½®ä¸Šä¸‹å†…è¾¹è· */
    line-height: 38px;
    /* æ–°å¢ï¼šè®©æ–‡å­—åœ¨å›ºå®šé«˜åº¦çš„æŒ‰é’®å†…å‚ç›´å±…ä¸­ */
}

/* --- ä¿®å¤ç»“æŸ --- */


#moments-multi-select-bar {
    display: none !important;
}

/* å¾®è°ƒåº•éƒ¨å¯¼èˆªæ ·å¼ï¼ˆä¸ä¼šå½±å“ä½ åŸæœ‰ .dockï¼‰ */
.bottom-nav {
    position: absolute;
    left: 0;
    right: 0;
    height: 68px;
    display: flex;
    gap: 6px;
    align-items: center;
    justify-content: center;
    padding: 10px 14px;
    box-sizing: border-box;
    background: rgba(255, 255, 255, 0.85);
    border-top-left-radius: 18px;
    border-top-right-radius: 18px;
    box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.06);
    z-index: 50;
    bottom: 0;
}

.bottom-nav .nav-btn {
    flex: 1;
    height: 48px;
    border-radius: 12px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    background: transparent;
    color: var(--text-color, #444);
}

.bottom-nav .nav-btn.active {
    background: var(--primary-color, #ff80ab);
    color: #fff;
    box-shadow: 0 6px 16px rgba(255, 128, 171, 0.22);
}

/* moments åˆ—è¡¨é¡¹ */
.moment-item {
    background: #fff;
    border-radius: 14px;
    padding: 12px;
    margin-bottom: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
}

.moment-head {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 8px;
}

.moment-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    object-fit: cover;
    background: #eee;
    flex-shrink: 0;
}

.moment-meta {
    font-size: 13px;
}

.moment-text {
    margin: 8px 0;
    white-space: pre-wrap;
    color: var(--text-color, #333);
}

.moment-image {
    width: 100%;
    max-height: 260px;
    object-fit: cover;
    border-radius: 10px;
    margin-top: 8px;
}

.moment-comments {
    margin-top: 10px;
    padding-top: 8px;
    border-top: 1px solid #faf0f4;
    color: #666;
    font-size: 13px;
}

.moment-comment {
    margin-bottom: 6px;
}

/* --- æ–°å¢ï¼šåŠ¨æ€æ“ä½œæ  (ç‚¹èµ/è¯„è®º) --- */
.moment-actions {
    display: flex;
    gap: 12px;
    margin-top: 12px;
    padding-top: 8px;
    border-top: 1px solid #f5f5f5;
}

.moment-action-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: #888;
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 13px;
}

.moment-action-btn svg {
    width: 18px;
    height: 18px;
    fill: currentColor;
}

.moment-action-btn.liked {
    color: var(--primary-color);
}

/* --- æ–°å¢ï¼šç‚¹èµåˆ—è¡¨æ˜¾ç¤º --- */
.moment-likes {
    background-color: #f9f9f9;
    padding: 6px 10px;
    border-radius: 8px;
    font-size: 13px;
    color: #555;
    margin-top: 8px;
    display: none;
    /* é»˜è®¤éšè— */
}

.moment-likes.visible {
    display: block;
}

.moment-likes .like-icon {
    color: var(--primary-color);
    margin-right: 4px;
}

/* --- æ–°å¢ï¼šç”¨æˆ·è¯„è®ºè¾“å…¥åŒºåŸŸ --- */
.moment-comment-input-area {
    display: none;
    /* Default hidden */
    gap: 8px;
    margin-top: 10px;
}

.moment-comment-input-area.visible {
    display: flex;
}

.moment-comment-input {
    flex-grow: 1;
    border: 1px solid #eee;
    border-radius: 15px;
    padding: 8px 12px;
    font-size: 13px;
}

.moment-comment-input:focus {
    outline: none;
    border-color: var(--primary-color);
}

.post-comment-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 15px;
    padding: 8px 12px;
    font-size: 13px;
    cursor: pointer;
    flex-shrink: 0;
}



/* --- å…¨å±€ç¾åŒ–ï¼šå¼•ç”¨æ¶ˆæ¯æ ·å¼ (å‚è€ƒå›¾ç‰‡æ ·å¼) --- */

/* 1. å¼•ç”¨å†…å®¹å—çš„æ•´ä½“æ ·å¼ */
.message-bubble .quoted-content {
    /* è®¾ç½®ä¸€ä¸ªæŸ”å’Œçš„æµ…ç°è‰²èƒŒæ™¯ */
    background-color: #f9c1c4;

    /* æ ¸å¿ƒï¼šç”¨å·¦è¾¹æ¡†æ¨¡æ‹Ÿç´«è‰²çš„ç«–çº¿ï¼Œé¢œè‰²ä¼šè·Ÿéšä¸»é¢˜å˜åŒ– */
    border-left: 3px solid var(--primary-color);

    /* è°ƒæ•´å†…å¤–è¾¹è·ï¼Œè®©å¸ƒå±€æ›´èˆ’é€‚ */
    padding: 8px 12px;
    margin-bottom: 8px;
    /* ä¸ä¸‹æ–¹çš„å›å¤æ–‡å­—æ‹‰å¼€è·ç¦» */

    /* è®¾ç½®åœ†è§’ */
    border-radius: 8px;

    /* é‡ç½®æ‰æ—§çš„è¾¹æ¡†æ ·å¼ */
    border-top: none;
    border-right: none;
    border-bottom: none;
}

/* 2. "å›å¤ XXX:" è¿™è¡Œæ–‡å­—çš„æ ·å¼ */
.message-bubble .quoted-content .quoted-sender {
    font-weight: 600;
    /* åŠ ç²— */
    font-size: 0.9em;
    /* å­—ä½“ç¨å¾®å°ä¸€ç‚¹ */
    color: var(--text-color);
    /* ä½¿ç”¨ä¸»é¢˜æ–‡å­—é¢œè‰² */
    display: block;
    /* ç¡®ä¿å®ƒå•ç‹¬å ä¸€è¡Œ */
    margin-bottom: 4px;
    /* ä¸è¢«å¼•ç”¨çš„å†…å®¹æ‹‰å¼€ä¸€ç‚¹è·ç¦» */
}

/* 3. è¢«å¼•ç”¨çš„æ¶ˆæ¯æ­£æ–‡æ ·å¼ */
.message-bubble .quoted-content .quoted-text {
    opacity: 0.7;
    /* è®©æ–‡å­—ç¨å¾®å˜æ·¡ï¼Œçªå‡ºå›å¤å†…å®¹ */
    font-size: 0.9em;
    word-wrap: break-word;
    white-space: pre-wrap;
}

/* 4. ç¡®ä¿æˆ‘ä»¬è‡ªå·±çš„å›å¤æ–‡å­—æ ·å¼æ­£å¸¸ */
.message-bubble .reply-text {
    margin-top: 0;
    /* ç§»é™¤å¤šä½™çš„é¡¶éƒ¨é—´è· */
}

/* 5. ä¸ºæ·±è‰²ä¸»é¢˜é€‚é… */
.dark-mode .message-bubble .quoted-content {
    background-color: rgba(255, 255, 255, 0.1);
    color: #ccc;
}

/* --- è®ºå›â€œ+â€å·å‘å¸–æŒ‰é’®ç¾åŒ–ä¸å®šä½ --- */
.new-post-btn {
    position: absolute;
    /* ä½¿ç”¨ç»å¯¹å®šä½ï¼Œè®©å®ƒæµ®åŠ¨èµ·æ¥ */
    bottom: 80px;
    /* è·ç¦»åº•éƒ¨20åƒç´  */
    right: 20px;
    /* è·ç¦»å³ä¾§20åƒç´  */

    /* ä»¥ä¸‹æ˜¯ç¾åŒ–æ ·å¼ */
    width: 60px;
    height: 60px;
    border-radius: 50%;
    /* å˜æˆåœ†å½¢ */
    background-color: var(--primary-color);
    /* ä½¿ç”¨ä¸»é¢˜ç²‰è‰² */
    color: white;
    font-size: 36px;
    font-weight: 300;
    /* è®©â€œ+â€å·ç»†ä¸€ç‚¹ï¼Œæ›´å¥½çœ‹ */
    line-height: 60px;
    /* å‚ç›´å±…ä¸­â€œ+â€å· */
    text-align: center;
    /* æ°´å¹³å±…ä¸­â€œ+â€å· */
    box-shadow: 0 4px 15px rgba(255, 128, 171, 0.4);
    /* æ·»åŠ æ¼‚äº®çš„ç²‰è‰²é˜´å½± */
    cursor: pointer;
    z-index: 100;
    /* ç¡®ä¿å®ƒåœ¨å¸–å­åˆ—è¡¨çš„ä¸Šæ–¹ */
    transition: transform 0.2s ease;
    /* æ·»åŠ ä¸€ä¸ªå°çš„äº¤äº’åŠ¨ç”» */
}

/* é¼ æ ‡æ‚¬åœæ—¶ï¼ŒæŒ‰é’®ç¨å¾®æ”¾å¤§ä¸€ç‚¹ç‚¹ */
.new-post-btn:hover {
    transform: scale(1.1);
}

/* --- æ”¯ä»˜å¯†ç å¼€å…³Toggle Switchæ ·å¼ --- */
.form-group.toggle-group {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 28px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-switch .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 28px;
}

.toggle-switch .slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked+.slider {
    background-color: var(--primary-color);
}

input:checked+.slider:before {
    transform: translateX(22px);
}

/* --- åœ¨ <style> æ ‡ç­¾æœ«å°¾æ·»åŠ  --- */

/* --- è®ºå›åŠŸèƒ½æœ€ç»ˆå¸ƒå±€å’Œæ ·å¼ (ä¸¥æ ¼å‚è€ƒå·²æœ‰èŒƒä¾‹) --- */

/* æ ¸å¿ƒï¼šè®©å†…å®¹åŒºæ­£ç¡®å¡«å……ï¼Œå¹¶å±…ä¸­ç‰ˆå—æŒ‰é’® */
#forum-screen .content {
    height: auto !important;
    flex-grow: 1 !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 20px !important;
    position: relative;
    overflow: hidden;
    /* é˜²æ­¢åŠ¨ç”»å…ƒç´ æº¢å‡º */
}

/* é¡¶éƒ¨å¯¼èˆªæ ä¸‹æ‹‰èœå•è§¦å‘å™¨ */
#forum-screen .forum-header {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    user-select: none;
}

#forum-screen .forum-header h1 {
    font-size: 18px;
    font-weight: 600;
    margin: 0;
    color: var(--text-color);
}

#forum-screen .forum-header .dropdown-arrow {
    width: 24px;
    height: 24px;
    fill: var(--text-color);
    margin-left: 5px;
    transition: transform 0.2s ease;
}

#forum-screen .forum-header.open .dropdown-arrow {
    transform: rotate(180deg);
}

/* ä¸‹æ‹‰èœå•æœ¬ä½“ */
.forum-dropdown-menu {
    position: absolute;
    top: 5px;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    z-index: 200;
    display: none;
}

.forum-dropdown-menu.visible {
    display: block;
}

.forum-dropdown-item {
    padding: 15px 20px;
    font-size: 16px;
    cursor: pointer;
    border-bottom: 1px solid #f0f0f0;
}

.forum-dropdown-item:last-child {
    border-bottom: none;
}

.forum-dropdown-item:hover {
    background-color: #fce4ec;
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* å››ä¸ªç‰ˆå—çš„æ ¼å­å¸ƒå±€ */
.forum-board-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    width: 100%;
}

/* ç‰ˆå—å¡ç‰‡ç¾åŒ– */
.forum-board-card {
    background: linear-gradient(145deg, #ffffff, #fff0f5);
    border-radius: 24px;
    padding: 20px;
    box-shadow: 0 8px 25px rgba(255, 128, 171, 0.1);
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    opacity: 0;
    animation: fadeInUp 0.5s ease forwards;
}

.forum-board-card:nth-child(1) {
    animation-delay: 0.1s;
}

.forum-board-card:nth-child(2) {
    animation-delay: 0.2s;
}

.forum-board-card:nth-child(3) {
    animation-delay: 0.3s;
}

.forum-board-card:nth-child(4) {
    animation-delay: 0.4s;
}

.forum-board-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 30px rgba(255, 128, 171, 0.2);
}

.forum-board-card img {
    width: 48px;
    height: 48px;
    object-fit: contain;
}

.forum-board-card .board-name {
    font-size: 16px;
    font-weight: 600;
    color: var(--secondary-color);
}

.notification-banner {
    position: absolute;
    top: 45px;
    /* æ ¹æ®ä½ çš„headeré«˜åº¦å¾®è°ƒ */
    left: 50%;
    transform: translateX(-50%) translateY(-200%);
    width: 90%;
    max-width: 380px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    padding: 10px;
    z-index: 999;
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
}

.notification-banner.show {
    transform: translateX(-50%) translateY(0);
}

.notification-banner img {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    margin-right: 10px;
    object-fit: cover;
    flex-shrink: 0;
}

.notification-banner #notification-text {
    flex-grow: 1;
    font-size: 14px;
    color: #333;
    line-height: 1.4;
}

.notification-banner button {
    background: none;
    border: none;
    font-size: 24px;
    color: #aaa;
    cursor: pointer;
    padding: 0 5px;
}

/* --- è®ºå›å‘å¸–å¼¹çª—ç¾åŒ– --- */
#new-post-modal .modal-window {
    background: #fff8fa;
    /* æ·¡ç²‰è‰²èƒŒæ™¯ */
    border: 1px solid #fce4ec;
}

#new-post-modal h3 {
    color: var(--primary-color);
    text-align: center;
}

#new-post-modal .form-group label {
    color: var(--secondary-color);
    font-weight: 600;
    font-size: 14px;
}

#new-post-modal .form-group input[type="text"],
#new-post-modal .form-group textarea {
    background-color: #fff;
    border: 2px solid #fde9f2;
    border-radius: 12px;
    padding: 12px;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

#new-post-modal .form-group input[type="text"]:focus,
#new-post-modal .form-group textarea:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 8px rgba(255, 128, 171, 0.2);
    outline: none;
}

#new-post-modal .form-group input[type="checkbox"] {
    accent-color: var(--primary-color);
    /* è®©å‹¾é€‰æ¡†ä¹Ÿå˜æˆç²‰è‰² */
    transform: scale(1.2);
    /* ç¨å¾®æ”¾å¤§ä¸€ç‚¹ç‚¹ */
    cursor: pointer;
}


/* --- è®ºå›å¸–å­åˆ—è¡¨ä¸è¯¦æƒ…é¡µç¾åŒ– --- */

/* å¸–å­åˆ—è¡¨é¡¹çš„æ•´ä½“æ ·å¼ */
.thread-list-item {
    background-color: #fff;
    border-radius: 16px;
    padding: 18px;
    margin-bottom: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    border: 1px solid #f0f0f0;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.thread-list-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
}

.thread-list-item.pinned {
    background-color: #fffafc;
    border-left: 4px solid var(--primary-color);
}

/* å¸–å­æ ‡é¢˜ */
.thread-title {
    font-weight: bold;
    font-size: 17px;
    margin-bottom: 12px;
    color: #333;
    display: flex;
    align-items: center;
}

.thread-title .hot-icon {
    font-size: 18px;
    margin-right: 5px;
}

/* ä½œè€…ã€ç‚¹èµç­‰å…ƒä¿¡æ¯ */
.thread-meta {
    font-size: 13px;
    color: #999;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f5f5f5;
}

.thread-meta .author {
    color: #5c7e9f;
    font-weight: bold;
}

.thread-meta .likes {
    color: var(--primary-color);
    font-weight: bold;
}

/* è¯„è®ºé¢„è§ˆåŒº */
.thread-comment-preview {
    font-size: 14px;
    color: #555;
    line-height: 1.6;
}

.thread-comment-preview .comment {
    margin-bottom: 8px;
}

.thread-comment-preview .comment:last-child {
    margin-bottom: 0;
}

.thread-comment-preview .comment-author {
    font-weight: bold;
    color: #444;
    margin-right: 5px;
}

/* --- å¸–å­è¯¦æƒ…é¡µç¾åŒ– --- */
.thread-full-content {
    padding: 20px;
}

.thread-full-content h2 {
    /* è¯¦æƒ…é¡µæ ‡é¢˜ */
    font-size: 22px;
    font-weight: 700;
    color: #333;
    margin: 0 0 10px 0;
}

.thread-full-content .author-line {
    /* ä½œè€…ä¿¡æ¯è¡Œ */
    font-size: 14px;
    color: #888;
    margin: 0 0 20px 0;
}

.thread-full-content .main-post-body {
    /* å¸–å­æ­£æ–‡ */
    font-size: 16px;
    line-height: 1.8;
    color: #444;
}

.comments-section {
    padding: 0 20px 20px 20px;
}

.comments-section h3 {
    /* â€œè¯„è®ºåŒºâ€æ ‡é¢˜ */
    font-size: 18px;
    font-weight: 600;
    color: var(--secondary-color);
    padding-bottom: 10px;
    border-bottom: 2px solid #fce4ec;
    margin-bottom: 15px;
}

.thread-comment {
    border-bottom: 1px solid #f5f5f5;
    padding: 15px 0;
}

.thread-comment:last-child {
    border-bottom: none;
}

.thread-reply {
    /* æ¥¼ä¸­æ¥¼å›å¤ */
    background-color: #f9f9f9;
    border-radius: 8px;
    padding: 10px;
    margin-top: 10px;
    margin-left: 20px;
    font-size: 14px;
}

/* --- è®ºå›å†…å®¹åŒºåŸŸé˜²é®æŒ¡ä¿®å¤ --- */
#forum-screen .thread-list-container,
#forum-thread-screen .content {
    /* å¢åŠ ä¸€ä¸ªè¶³å¤Ÿé«˜çš„åº•éƒ¨å†…è¾¹è·ï¼Œä¸ºå¯¼èˆªæ ç•™å‡ºç©ºé—´ */
    padding-bottom: 80px;
}

/* --- è§†é¢‘é€šè¯åŠŸèƒ½æ ·å¼ (æœ€ç»ˆä¿®æ­£ç‰ˆ) --- */
.sticker-bar-btn#voice-call-btn {
    display: none;
}

/* ã€è¯·ç”¨ä¸‹é¢è¿™æ®µä¿®æ­£åçš„ä»£ç æ›¿æ¢ä¸Šé¢çš„ä»£ç ã€‘ */
#voice-call-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    z-index: 300;
    display: none;
    flex-direction: column;
    /* justify-content: flex-start;  <---  å°†è¿™ä¸€è¡Œåˆ é™¤ */
    align-items: center;
    color: white;
    text-align: center;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

#voice-call-overlay.visible {
    display: flex;
}

.call-avatar-large {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 15px;
    border: 4px solid rgba(255, 255, 255, 0.5);
    margin-top: 40px;
    flex-shrink: 0;
}

.call-name {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 10px;
    flex-shrink: 0;
}

.call-status {
    font-size: 16px;
    color: #ccc;
    min-height: 24px;
    margin-bottom: 15px;
    flex-shrink: 0;
}

/* èŠå¤©è®°å½•åŒºåŸŸçš„æ ¸å¿ƒä¿®å¤ */
#call-transcript-area {
    flex: 1;
    /* å…³é”®ï¼šè®©æ­¤åŒºåŸŸè‡ªåŠ¨ä¼¸å±•å¹¶å æ®æ‰€æœ‰å‰©ä½™ç©ºé—´ */
    width: 100%;
    overflow-y: auto;
    /* å†…å®¹å¤šæ—¶å¯ä»¥æ»šåŠ¨ */
    min-height: 0;
    /* flexå¸ƒå±€çš„å…³é”®æŠ€å·§ï¼Œé˜²æ­¢å†…å®¹æº¢å‡º */
    padding: 10px;
    font-size: 15px;
    line-height: 1.7;
    text-align: left;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.call-transcript-line {
    margin-bottom: 12px;
}

.call-transcript-line .action {
    color: #aaa;
    font-style: italic;
}

.call-transcript-line .dialog {
    color: #fff;
}

/* åº•éƒ¨è¾“å…¥æ¡†å’ŒæŒ‰é’® */
#call-input-area {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 0 0 0;
    /* åªä¿ç•™ä¸Šè¾¹è· */
    width: 100%;
    flex-shrink: 0;
}

#call-input {
    flex-grow: 1;
    border: none;
    padding: 12px;
    border-radius: 18px;
    background-color: rgba(255, 255, 255, 0.2);
    color: white;
}

#call-input::placeholder {
    color: #ccc;
}

#send-call-message-btn {
    background: var(--primary-color);
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    color: white;
    font-size: 18px;
    flex-shrink: 0;
}

/* é€šè¯æŒ‰é’®ç»„ */
.call-button-group {
    position: absolute;
    bottom: 80px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-around;
    align-items: center;
}

.call-button {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    background: none;
    border: none;
    color: white;
}

.call-button .icon-wrapper {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 10px;
}

.call-button svg {
    width: 36px;
    height: 36px;
    fill: white;
}

.call-button.decline .icon-wrapper {
    background-color: #ef5350;
}

.call-button.accept .icon-wrapper {
    background-color: #4CAF50;
}

/* å°†æŒ‚æ–­æŒ‰é’®ä¹Ÿæ”¾å…¥è¿™ä¸ªç»„ï¼Œä½†ç”±JSæ§åˆ¶æ˜¾éš */
#hangup-button-container {
    position: static;
    padding: 10px 0;
    flex-shrink: 0;
}

/* --- åœ¨ <style> æ ‡ç­¾æœ«å°¾æ·»åŠ  --- */


.mention-panel {
    position: absolute;
    background: white;
    border: 1px solid #eee;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    max-height: 150px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
}

.mention-item {
    padding: 8px 12px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.mention-item:hover {
    background-color: #f5f5f5;
}

.mention-item img {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    object-fit: cover;
}

/* --- AIè½¨è¿¹å¼¹çª—æ ·å¼ --- */
#trajectory-modal {
    z-index: 105;
    /* ç¡®ä¿å®ƒåœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Š */
}

#trajectory-modal .modal-window {
    width: 90%;
    max-width: 380px;
    padding: 20px;
}

#trajectory-timeline {
    max-height: 60vh;
    overflow-y: auto;
    padding-right: 15px;
    /* ä¸ºæ»šåŠ¨æ¡ç•™å‡ºç©ºé—´ */
    position: relative;
    border-left: 2px solid #fce4ec;
    /* æ—¶é—´è½´çš„ç«–çº¿ */
    margin-left: 25px;
}

.trajectory-item {
    position: relative;
    padding: 10px 0 15px 25px;
}

.trajectory-item::before {
    content: '';
    position: absolute;
    left: -7px;
    /* (12px / 2) + 2px border */
    top: 12px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: var(--primary-color);
    border: 2px solid #fff;
    z-index: 1;
}

.trajectory-time {
    font-weight: bold;
    color: var(--primary-color);
    font-size: 16px;
    display: block;
    margin-bottom: 5px;
}

.trajectory-event {
    font-size: 14px;
    color: var(--text-color);
    line-height: 1.5;
}

/* --- æ—¶é—´æ—¥æœŸå°éƒ¨ä»¶æ ·å¼ä¿®æ”¹ --- */

/* 1. å°†å°éƒ¨ä»¶å®¹å™¨æ”¹ä¸ºç»å¯¹å®šä½ï¼Œæ”¾ç½®åœ¨å±å¹•é¡¶éƒ¨ï¼Œå¹¶ä½¿ç”¨flexå¸ƒå±€ */
.time-widget {
    position: absolute;
    top: 0px;
    /* è·ç¦»å±å¹•é¡¶éƒ¨çš„é—´è· */
    left: 0;
    width: 100%;
    padding: 0 20px;
    /* å·¦å³ä¸¤è¾¹çš„é—´è· */

    /* æ ¸å¿ƒæ”¹åŠ¨ï¼šä½¿ç”¨flexå¸ƒå±€å®ç°å·¦å³å¯¹é½ */
    display: flex;
    justify-content: space-between;
    align-items: center;

    text-align: unset;
    /* å–æ¶ˆåŸæœ‰çš„å±…ä¸­å¯¹é½ */
    color: var(--text-color);
    /* ä¸ºæ—¥æœŸå’Œæ—¶é—´è®¾ç½®ç»Ÿä¸€çš„é»˜è®¤é¢œè‰² */
}

/* 2. ç»Ÿä¸€ä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´çš„å­—ä½“æ ·å¼ */
.time-widget .date,
.time-widget .time {
    font-size: 11px;
    /* ç¼©å°å­—ä½“å¤§å° */
    font-weight: 500;
    /* ç»Ÿä¸€å­—ä½“ç²—ç»†ä¸ºä¸­ç­‰ */
    color: inherit;
    /* ç»§æ‰¿æ¥è‡ªçˆ¶å®¹å™¨ .time-widget çš„é¢œè‰² */
}

/* 3. ç¡®ä¿æ—¥é—´æ¨¡å¼ä¸‹çš„é¢œè‰²ä¾ç„¶ç”Ÿæ•ˆ */
#home-screen.day-mode .time-widget {
    color: var(--white-color);
    /* æ—¥é—´æ¨¡å¼ç»Ÿä¸€ä½¿ç”¨ç™½è‰² */
}

/* --- æœ€ç»ˆç‰ˆä¸»å±å¹•å¸ƒå±€æ ·å¼ --- */

/* 1. æ•´ä½“å±å¹•å’Œå†…å®¹åŒºè®¾å®š */
#home-screen {
    justify-content: flex-start;
    /* å†…å®¹ä»é¡¶éƒ¨å¼€å§‹æ’åˆ— */
    padding-top: 50px;
    /* å¢åŠ é¡¶éƒ¨å†…è¾¹è·ï¼Œä¸ºæ—¶é—´æ—¥æœŸå°éƒ¨ä»¶ç•™å‡ºç©ºé—´ */
}

#home-screen .main-content-area {
    display: flex;
    width: 100%;
    /* å®½åº¦å æ»¡ï¼Œä»¥ä¾¿å·¦å³å¯¹é½ */
    justify-content: space-between;
    /* æ ¸å¿ƒï¼šå°†å·¦å³ä¸¤åˆ—æ¨å‘å±å¹•è¾¹ç¼˜ */
    align-items: flex-start;
    padding: 0 40px;
    /* å±å¹•å·¦å³ç•™å‡ºè¾¹è· */
    margin-top: 20px;
    /* ä¸ä¸Šæ–¹å…ƒç´ çš„é—´è· */
}

/* 2. å·¦å³ä¸¤åˆ—çš„å®¹å™¨ */
.left-column,
.right-column {
    display: flex;
    flex-direction: column;
    gap: 15px;
    /* åˆ—å†…å…ƒç´ çš„å‚ç›´é—´è· */
}

/* 3. å·¦ä¾§è”ç³»äººç»„ä»¶æ ·å¼ï¼ˆè¿›ä¸€æ­¥ç¼©å°ï¼‰ */
.contact-widgets-column {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.contact-widget {
    background-color: #f5f5f5;
    border-radius: 50px;
    padding: 5px 12px 5px 5px;
    /* ç¼©å°å†…è¾¹è· */
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 160px;
    /* ç¼©å°å®½åº¦ */
    box-shadow: none;
    /* ç§»é™¤é˜´å½±ï¼Œæ›´ç®€æ´ */
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.contact-widget:hover {
    background-color: #e9e9e9;
}

.contact-widget img {
    width: 40px;
    /* ç¼©å°å¤´åƒ */
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

.contact-widget span {
    font-weight: 500;
    color: #444;
    font-size: 13px;
    /* ç¼©å°å­—ä½“ */
}

.contact-widget.avatar-right {
    flex-direction: row-reverse;
    padding: 5px 5px 5px 12px;
}

/* 4. å·¦ä¾§ä¸‹æ–¹çš„â€œè‡ªå®šä¹‰â€å’Œâ€œå£çº¸â€å®¹å™¨ï¼ˆæ”¹ä¸ºæ¨ªå‘æ’åˆ—ï¼‰ */
.secondary-apps-dock {
    display: flex;
    justify-content: center;
    /* å›¾æ ‡å±…ä¸­æ’åˆ— */
    gap: 15px;
    /* å›¾æ ‡é—´è· */
    padding: 8px;
    border-radius: 18px;
}

/* 5. å³ä¾§2x2åº”ç”¨ç½‘æ ¼ï¼ˆç¼©å°å°ºå¯¸ï¼‰ */
.small-app-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
}

.small-app-grid .app-icon .icon-img,
.secondary-apps-dock .app-icon .icon-img {
    width: 50px;
    /* ç»Ÿä¸€ç¼©å°å›¾æ ‡å°ºå¯¸ */
    height: 50px;
    border-radius: 11px;
    margin-bottom: 4px;
}

.small-app-grid .app-icon .app-name,
.secondary-apps-dock .app-icon .app-name {
    font-size: 10px;
    /* ç»Ÿä¸€ç¼©å°æ–‡å­—å¤§å° */
}

/* 6. éŸ³ä¹æ’­æ”¾å™¨æ–°ä½ç½®å’Œå°ºå¯¸ */
.record-player-widget {
    --music-widget-scale: 1.2;
    /* å†æ¬¡ç¼©å°ç»„ä»¶ */
    margin: 0 auto;
    /* ç§»é™¤ä¸Šä¸‹å¤–è¾¹è·ï¼Œç”±çˆ¶å®¹å™¨gapæ§åˆ¶ */
    width: 100%;
    /* å®½åº¦ä¸çˆ¶å®¹å™¨ï¼ˆå³åˆ—ï¼‰å¯¹é½ */
    max-width: calc(130px * var(--music-widget-scale));
    height: calc(100px * var(--music-widget-scale));
}

.record-player-widget .vinyl-record {
    right: -12%;
}

/* 7. åº•éƒ¨Dockæ è°ƒæ•´ */
.dock {
    margin: 60px 20px 10px;
    /* ä¸Š å·¦å³ ä¸‹ çš„é—´è· */
}

/* 8. ç¡®ä¿æ—§çš„å¸ƒå±€è§„åˆ™è¢«ç¦ç”¨ */
#home-screen .top-row,
#home-screen .bottom-row,
#home-screen .app-grid,
#home-screen .decorative-component {
    display: none !important;
}

/* =============================================================== */
/* START: å¿ƒçµç¾ç»Š - ç»‘å®šåŠŸèƒ½æ ·å¼ */
/* =============================================================== */

#bond-invitation-screen .content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 20px;
    background: linear-gradient(135deg, #FFF9E0, #FFEEC1);
    /* æ·¡é»„è‰²æ¸å˜èƒŒæ™¯ */
}

.bond-invite-card {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    border-radius: 24px;
    padding: 30px 20px;
    width: 100%;
    max-width: 380px;
    text-align: center;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
}

.bond-invite-card h2 {
    font-size: 20px;
    font-weight: 600;
    color: #A17400;
    margin: 0;
}

.bond-invite-card p {
    font-size: 14px;
    color: #B89B4E;
    margin: 8px 0 25px 0;
}

.bond-invite-avatars {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-bottom: 30px;
    position: relative;
}

.bond-invite-avatars .heart-connector {
    color: var(--primary-color);
    font-size: 24px;
    margin: 0 10px;
}

.bond-avatar-placeholder {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    position: relative;
}

.bond-avatar-placeholder img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid white;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.bond-avatar-placeholder .status-badge {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: #FFC107;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border: 2px solid white;
}

.bond-avatar-placeholder.invitee {
    border: 3px dashed #FFD54F;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    color: #FFD54F;
    background-color: #FFFDE7;
    cursor: pointer;
}

.bond-avatar-placeholder .avatar-name {
    margin-top: 8px;
    font-weight: 500;
    color: #555;
}

.bond-invite-btn {
    width: 100%;
    padding: 15px;
    border-radius: 25px;
    border: none;
    background: #FFC107;
    color: #A17400;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
}

/* AIå‘é€çš„ç»‘å®šé‚€è¯·å¡ç‰‡æ ·å¼ */
.bond-request-card {
    width: 240px;
    border-radius: var(--border-radius);
    margin: 0 8px;
    background: linear-gradient(135deg, #FFD54F, #FFC107);
    color: #8C6500;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.bond-request-card p {
    margin: 0 0 15px 0;
    font-weight: 500;
}

.bond-request-actions {
    display: flex;
    gap: 10px;
}

.bond-request-actions button {
    flex: 1;
    border-radius: 12px;
    padding: 10px;
    font-weight: bold;
}

.bond-request-status {
    font-weight: bold;
    margin-top: 15px;
    font-size: 14px;
}

/* =============================================================== */
/* END: å¿ƒçµç¾ç»Š - ç»‘å®šåŠŸèƒ½æ ·å¼ */
/* =============================================================== */


.icity-moments-inner {
    --icity-hero-h: 154px;
    /* 70% of original 220px */
    --icity-avatar-size: 98px;
    /* 70% of original 140px */
    position: relative;
    box-sizing: border-box;
}

.icity-hero {
    height: var(--icity-hero-h) !important;
    position: relative;
    overflow: hidden;
    border-radius: 14px 14px 0 0;
    box-sizing: border-box;
}

.icity-avatar-wrap {
    position: absolute !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: var(--icity-avatar-size) !important;
    height: var(--icity-avatar-size) !important;
    border-radius: 50% !important;
    top: calc(var(--icity-hero-h) - (var(--icity-avatar-size) * 0.7)) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    z-index: 50 !important;
    background: #fff !important;
    box-shadow: 0 8px 22px rgba(0, 0, 0, 0.12) !important;
    border: 6px solid rgba(255, 255, 255, 0.95) !important;
    box-sizing: border-box !important;
    overflow: visible !important;
}

.icity-avatar-wrap img,
.icity-avatar-wrap .avatar-img {
    width: 80% !important;
    height: 80% !important;
    border-radius: 50% !important;
    object-fit: cover !important;
    display: block !important;
}

.icity-info-card {
    position: relative !important;
    padding-top: calc(var(--icity-avatar-size) * 0.2 + 4px) !important;
    /* Reduced top padding */
    padding-right: 18px !important;
    padding-left: 18px !important;
    padding-bottom: 10px !important;
    /* Reduced bottom padding */
    margin-top: 10px !important;
    background: #fff !important;
    border-radius: 14px !important;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.04) !important;
    box-sizing: border-box !important;
    text-align: center !important;
}

/* Reduce vertical spacing and font sizes for a more compact info card */
.icity-name {
    font-size: 18px !important;
    line-height: 1.1 !important;
}

.icity-id-loc {
    margin-top: 6px !important;
    font-size: 12px !important;
    line-height: 1.1 !important;
}

.icity-signature {
    margin-top: 8px !important;
    font-size: 13px !important;
    line-height: 1.2 !important;
}

@media (max-width: 420px) {
    .icity-moments-inner {
        --icity-hero-h: 112px;
        /* 70% of previous 160px */
        --icity-avatar-size: 77px;
        /* 70% of previous 110px */
    }
}


/* Conservative selectors for avatar containers and images */
.icity-avatar-wrap,
.avatar-wrap,
.profile-avatar,
.header-avatar,
.my-avatar,
.top-avatar,
.avatar-circle,
.avatar-holder {
    background: transparent !important;
    padding: 0 !important;
    border: 0 !important;
    overflow: hidden !important;
    border-radius: 50% !important;
    display: inline-block !important;
}

/* Ensure the img fills the container */
.icity-avatar-wrap img,
.avatar-wrap img,
.profile-avatar img,
.header-avatar img,
.my-avatar img,
.top-avatar img,
img.avatar-img,
img[data-role="avatar"] {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    display: block !important;
    border-radius: 50% !important;
    background: transparent !important;
    padding: 0 !important;
    margin: 0 auto !important;
}

/* If the container uses an inner padding element, hide it */
.icity-avatar-wrap .inner-avatar,
.avatar-wrap .inner,
.avatar-inner {
    display: none !important;
}


.moment-image-desc-card {
    background: #eef0f3 !important;
    /* æµ…ç°åº•è‰² - è¦†ç›–åŸæœ‰æ¸å˜ */
    border: 6px solid #ffffff !important;
    box-shadow: 0 6px 20px rgba(10, 10, 20, 0.06) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;

    padding: 12px 14px !important;
    margin-top: 6px !important;
    min-height: 86px !important;
}

.moment-image-desc-card .desc-content {
    font-size: 13px !important;
}

.moment-image-desc-card .desc-content,
.moment-image-desc-card p.desc-content {
    color: #66676b !important;
    background: transparent !important;
}

/* å¦‚æœå­˜åœ¨å†…å±‚å®¹å™¨ï¼Œç¡®ä¿å»æ‰å…¶èƒŒæ™¯å¹¶ä½¿ç”¨æµ…ç°è‰² */
.moment-image-desc-card>.inner,
.moment-image-desc-card>.card-inner,
.moment-image-desc-card>.content {
    background: transparent !important;
}


.moment-image-desc-card,
.moment-image-desc-card *,
.moment-image-desc-card .desc-content,
.moment-image-desc-card .description,
.moment-image-desc-card .image-desc,
.moment-image-desc-card .desc {
    text-shadow: none !important;
    -webkit-text-shadow: none !important;
    filter: none !important;
}


/* Try to scope to likely modal/dialog containers without touching other buttons */
/* If your modal has a specific id or class, replace .publish-modal below with it. */
.publish-modal,
.publish-dialog,
.moment-publish-modal,
.dialog-publish,
.publishBox {
    /* ensure modal content uses flex column so footer aligns correctly */
    display: block;
}

/* Make the actions row use flex so buttons are equal size and aligned */
.publish-modal .actions,
.publish-dialog .actions,
.moment-publish-modal .actions,
.dialog-publish .actions,
.publishBox .actions,
.publish-actions {
    display: flex !important;
    gap: 12px;
    align-items: center;
    justify-content: space-between;
    padding: 0 !important;
}

/* Ensure buttons inside actions share equal width and similar height */
.publish-modal .actions button,
.publish-dialog .actions button,
.moment-publish-modal .actions button,
.dialog-publish .actions button,
.publishBox .actions button,
.publish-actions button {
    flex: 1 1 0;
    max-width: none;
    min-width: 0;
    height: 52px;
    border-radius: 12px;
    font-weight: 600;
    padding: 0 16px;
    box-sizing: border-box;
}

/* Make the cancel button visually secondary if needed */
.publish-modal .actions .cancel,
.publish-dialog .actions .cancel,
.publishBox .actions .cancel,
.publish-actions .cancel {
    background: #bfe6ff;
    /* light blue like your screenshot */
    color: #fff;
}

/* Publish button primary color */
.publish-modal .actions .primary,
.publish-dialog .actions .primary,
.publishBox .actions .primary,
.publish-actions .primary {
    background: #ff95bf;
    /* pink from screenshot */
    color: #fff;
}

/* Tighten spacing for the "add image" checkbox area */
.add-image-row,
.add-image,
.image-checkbox,
.add-photo,
.add-picture {
    margin-top: 6px !important;
    margin-bottom: 6px !important;
    display: flex !important;
    gap: 8px;
    align-items: center;
}

/* If checkbox itself has large margin, reduce it */
.add-image-row input[type="checkbox"],
.image-checkbox input[type="checkbox"],
.add-photo input[type="checkbox"] {
    margin: 0 !important;
    transform: scale(1.05);
}

/* Small screens: keep buttons stacked but full-width with proper gap */
@media (max-width: 420px) {

    .publish-modal .actions,
    .publish-dialog .actions,
    .moment-publish-modal .actions,
    .dialog-publish .actions,
    .publishBox .actions,
    .publish-actions {
        flex-direction: column;
    }

    .publish-modal .actions button,
    .publish-dialog .actions button,
    .moment-publish-modal .actions button,
    .dialog-publish .actions button,
    .publishBox .actions button,
    .publish-actions button {
        width: 100%;
    }
}


/* Scope strictly to the post form to avoid affecting other UIs */
#post-form {
    font-family: inherit;
}

/* Find the action container which uses inline flex; ensure children buttons take equal space */
#post-form>div[style*="display:flex"] {
    display: flex !important;
    gap: 10px !important;
    margin-top: 12px !important;
    align-items: stretch !important;
}

/* Make buttons equal width, same height, and matching radius */
#post-form>div[style*="display:flex"] .btn {
    flex: 1 1 0 !important;
    min-width: 0 !important;
    height: 52px !important;
    padding: 0 16px !important;
    border-radius: 12px !important;
    box-sizing: border-box !important;
    font-weight: 600 !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* If there are specific modifier classes, ensure colors remain similar to your theme */
#post-form>div[style*="display:flex"] .btn-sec {
    background: #bfe6ff !important;
    color: #fff !important;
    border: none !important;
}

#post-form>div[style*="display:flex"] .btn-primary {
    background: #ff95bf !important;
    color: #fff !important;
    border: none !important;
}

/* Tighten the "æ·»åŠ å›¾ç‰‡" checkbox row */
#post-form .form-group label {
    display: inline-flex !important;
    align-items: center !important;
    gap: 8px !important;
    margin-top: 6px !important;
    cursor: pointer;
}

#post-form #add-image {
    margin: 0 !important;
    transform: scale(1.05) !important;
    vertical-align: middle !important;
}

/* Ensure image input group sits closer */
#image-input-group {
    margin-top: 8px !important;
    margin-bottom: 6px !important;
}

/* Small screens: stack buttons but keep spacing */
@media (max-width: 420px) {
    #post-form>div[style*="display:flex"] {
        flex-direction: column !important;
    }

    #post-form>div[style*="display:flex"] .btn {
        width: 100% !important;
    }
}


/* Prevent the label text from wrapping and ensure layout is inline */
#post-form .form-group label {
    white-space: nowrap !important;
    flex-wrap: nowrap !important;
    width: auto !important;
}

/* If any spans inside the label are forced to block, make them inline */
#post-form .form-group label span,
#post-form .form-group label b,
#post-form .form-group label i {
    display: inline !important;
}

/* Allow the label to take available horizontal space so text doesn't collapse */
#post-form .form-group {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
}

/* =============================================================== */
/* START: Peek æ‰‹æœºåŠŸèƒ½æ ·å¼ (ç§»æ¤è‡ª reference_UwU.html) */
/* =============================================================== */

/* --- Peek Album Styles (å·çœ‹ç›¸å†Œæ ·å¼) --- */
.album-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2px;
    padding: 2px;
}

.album-photo {
    position: relative;
    width: 100%;
    padding-bottom: 100%; /* 1:1 Aspect Ratio */
    background-color: #e9ecef;
    cursor: pointer;
}

.album-photo img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.video-indicator {
    position: absolute;
    bottom: 5px;
    right: 5px;
    background-color: rgba(0, 0, 0, 0.5);
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.video-indicator svg {
    width: 14px;
    height: 14px;
    fill: white;
    margin-left: 2px;
}

#peek-photo-modal .modal-window {
    width: 90%;
    max-width: 420px;
    padding: 15px;
    background-color: #fff;
    border-radius: 15px;
}

#peek-photo-image-container {
    width: 100%;
    max-height: 70vh;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    background-color: #f0f0f0;
    border-radius: 10px;
    overflow: hidden;
}

#peek-photo-image-container img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

#peek-photo-description {
    font-size: 15px;
    line-height: 1.6;
    color: #333;
    text-align: left;
    white-space: pre-wrap;
    padding: 0 5px 5px 5px;
    border-top: 1px solid #eee;
    margin-top: 15px;
    padding-top: 15px;
}

/* Peek Screen Specific Styles */
#peek-messages-screen .list-item:hover,
#peek-conversation-screen {
    background-color: #f8f9fa;
}

#peek-messages-screen .app-header,
#peek-conversation-screen .app-header {
    background-color: rgba(248, 249, 250, 0.85);
    border-bottom-color: rgba(0, 0, 0, 0.08);
}

#peek-messages-screen .back-btn,
#peek-conversation-screen .back-btn,
#peek-messages-screen .title,
#peek-conversation-screen .title {
    color: #212529;
}

#peek-messages-screen .chat-avatar {
    border-radius: 12px;
}

#peek-messages-screen .app-header .action-btn,
#peek-conversation-screen .app-header .action-btn,
#peek-cart-screen .app-header .action-btn,
#peek-transfer-station-screen .app-header .action-btn,
#peek-browser-screen .app-header .action-btn {
    color: #212529;
}

#peek-conversation-screen .message-bubble {
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

#peek-conversation-screen .message-bubble.received {
    background-color: #e9ecef;
    color: #343a40;
}

#peek-conversation-screen .message-bubble.sent {
    background-color: #007bff;
    color: white;
}

/* --- Peek Memos Screen --- */
#peek-memos-screen {
    background-color: #f9f9f9;
}

#peek-memos-screen .app-header .title,
#peek-memos-screen .app-header .back-btn,
#peek-memos-screen .app-header .action-btn {
    color: #212529;
}

#peek-memos-screen .content {
    padding: 0;
}

#peek-memos-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.memo-item {
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background-color 0.2s;
}

.memo-item:hover {
    background-color: #f0f0f0;
}

.memo-item-title {
    font-weight: 600;
    font-size: 16px;
    color: #333;
    margin: 0 0 5px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.memo-item-preview {
    font-size: 14px;
    color: #777;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* --- Peek Memo Detail Screen --- */
#peek-memo-detail-screen {
    background-color: #fff;
}

#peek-memo-detail-screen .app-header .title,
#peek-memo-detail-screen .app-header .back-btn,
#peek-memo-detail-screen .app-header .action-btn {
    color: #212529;
}

#peek-memo-detail-screen .content {
    padding: 0;
    display: flex;
    flex-direction: column;
}

/* --- Peek Cart Screen --- */
#peek-cart-screen {
    background-color: #f8f9fa;
}

#peek-cart-screen .app-header .title,
#peek-cart-screen .app-header .back-btn {
    color: #212529;
}

#peek-cart-screen .content {
    padding: 0;
}

.cart-item-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.cart-item {
    display: flex;
    align-items: center;
    padding: 15px 20px;
    background-color: #fff;
    border-bottom: 1px solid #eee;
}

.cart-item-image {
    width: 80px;
    height: 80px;
    border-radius: 10px;
    object-fit: cover;
    margin-right: 15px;
    background-color: #eee;
}

.cart-item-details {
    flex-grow: 1;
}

.cart-item-title {
    font-weight: 600;
    font-size: 15px;
    color: #333;
    margin: 0 0 5px 0;
}

.cart-item-spec {
    font-size: 13px;
    color: #888;
    margin-bottom: 8px;
}

.cart-item-price {
    font-size: 16px;
    font-weight: bold;
    color: #e53935;
}

.cart-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    padding-bottom: calc(15px + env(safe-area-inset-bottom));
    background-color: #fff;
    border-top: 1px solid #eee;
    flex-shrink: 0;
}

.cart-total-price {
    font-size: 18px;
    font-weight: bold;
    color: #e53935;
}

.cart-total-price .label {
    font-size: 14px;
    font-weight: normal;
    color: #333;
}

.checkout-btn {
    background-color: #e53935;
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 20px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
}

/* --- Peek Transfer Station Screen --- */
#peek-transfer-station-screen {
    background-color: #ededed;
}

#peek-transfer-station-screen .app-header {
    background-color: #ededed;
    border-bottom: 1px solid #dcdcdc;
}

#peek-transfer-station-screen .app-header .title,
#peek-transfer-station-screen .app-header .back-btn {
    color: #000;
}

#peek-transfer-station-screen .content {
    display: flex;
    flex-direction: column;
    padding: 0;
}

.transfer-station-input-area {
    flex-shrink: 0;
    padding: 8px;
    background-color: #f7f7f7;
    border-top: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
}

.transfer-station-input-area .fake-input {
    flex-grow: 1;
    background-color: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 5px;
    height: 36px;
}

.transfer-station-input-area .plus-btn {
    width: 36px;
    height: 36px;
    margin-left: 8px;
    background-image: url('https://i.postimg.cc/8PLqF514/icons8-48.png');
    background-size: 24px;
    background-position: center;
    background-repeat: no-repeat;
    background-color: #f7f7f7;
    border: none;
}

/* --- Peek Browser Screen --- */
#peek-browser-screen {
    background-color: #ffffff;
}

#peek-browser-screen .app-header .title,
#peek-browser-screen .app-header .back-btn {
    color: #212529;
}

#peek-browser-screen .content {
    padding: 15px 0;
}

.browser-history-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.browser-history-item {
    padding: 12px 20px;
    border-bottom: 1px solid #f0f0f0;
}

.browser-history-item:last-child {
    border-bottom: none;
}

.history-item-title {
    font-weight: 500;
    font-size: 16px;
    color: #0056b3;
    margin: 0 0 4px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.history-item-url {
    font-size: 13px;
    color: #888;
    margin: 0 0 8px 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.history-item-annotation {
    font-size: 14px;
    color: #555;
    line-height: 1.5;
    padding: 8px 12px;
    background-color: #f9f9f9;
    border-left: 3px solid #007bff;
    border-radius: 4px;
}

/* --- Peek Unlock Screen (å¾®åšå°å·) --- */
#peek-unlock-screen {
    background-color: #f5f5f5;
}

.unlock-profile-header {
    display: flex;
    align-items: center;
    padding: 20px;
    background-color: #fff;
    border-bottom: 1px solid #eee;
}

.unlock-profile-avatar {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 15px;
}

.unlock-profile-info {
    flex-grow: 1;
}

.unlock-profile-username {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin: 0 0 5px 0;
}

.unlock-profile-handle {
    font-size: 14px;
    color: #888;
    margin: 0;
}

.unlock-profile-bio {
    padding: 15px 20px;
    background-color: #fff;
    border-bottom: 1px solid #eee;
    font-size: 15px;
    line-height: 1.6;
    color: #333;
}

.unlock-profile-stats {
    display: flex;
    justify-content: space-around;
    padding: 15px 20px;
    background-color: #fff;
    border-bottom: 8px solid #f5f5f5;
}

.unlock-profile-stat {
    text-align: center;
}

.unlock-profile-stat .count {
    display: block;
    font-size: 18px;
    font-weight: bold;
    color: #333;
}

.unlock-profile-stat .label {
    display: block;
    font-size: 13px;
    color: #888;
    margin-top: 4px;
}

.unlock-post-feed {
    padding: 10px 0;
}

.unlock-post-card {
    background-color: #fff;
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
}

.unlock-post-card-header {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
}

.unlock-post-card-header img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 10px;
}

.unlock-post-card-author-info {
    flex-grow: 1;
}

.unlock-post-card-author-info .username {
    display: block;
    font-size: 15px;
    font-weight: 600;
    color: #333;
}

.unlock-post-card-author-info .timestamp {
    display: block;
    font-size: 12px;
    color: #888;
    margin-top: 2px;
}

.unlock-post-card-content {
    font-size: 15px;
    line-height: 1.6;
    color: #333;
    margin-bottom: 12px;
}

.unlock-post-card-actions {
    display: flex;
    justify-content: space-around;
    padding-top: 10px;
    border-top: 1px solid #f0f0f0;
}

.unlock-post-card-actions .action {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 13px;
    color: #888;
    cursor: pointer;
}

.unlock-post-card-actions .action svg {
    width: 18px;
    height: 18px;
    fill: #888;
}

/* =============================================================== */
/* END: Peek æ‰‹æœºåŠŸèƒ½æ ·å¼ */
/* =============================================================== */

/* =============================================================== */
/* START: ç¼–è¾‘æ¶ˆæ¯å¼¹çª—æ ·å¼ (ç§»æ¤è‡ª reference_UwU.html) */
/* =============================================================== */

#message-edit-modal .modal-window {
    width: 90%;
    max-width: 400px;
}

#message-edit-textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #fce4ec;
    border-radius: 10px;
    background-color: #fff;
    min-height: 120px;
    font-family: var(--font-family);
    font-size: 15px;
    resize: vertical;
}

#message-edit-textarea:focus {
    outline: none;
    border-color: var(--primary-color);
}

/* =============================================================== */
/* END: ç¼–è¾‘æ¶ˆæ¯å¼¹çª—æ ·å¼ */
/* =============================================================== */

